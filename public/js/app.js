/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.l = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// identity function for calling harmory imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };

/******/ 	// define getter function for harmory exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		Object.defineProperty(exports, name, {
/******/ 			configurable: false,
/******/ 			enumerable: true,
/******/ 			get: getter
/******/ 		});
/******/ 	};

/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};

/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

"use strict";
eval("'use strict';\n\n$(document).ready(function($) {\n    \n\n    // ------------------------------------------------------------------------\n    var $menu = $('.user-dropdown-menu');\n    $(\".user-image\").click(function(event) {\n        event.preventDefault();\n        $menu.toggleClass('open');\n    });\n\n\n    // ------------------------------------------------------------------------\n    function __log(e, data) {\n        console.log(e + \" \" + (data || ''));\n    }\n\n    var audio_context;\n    var recorder;\n    var recording = false;\n    var $form = $('form');\n    var currAudioBlob = null;\n    var $form = $(\"form\");\n    var $submitButton = $(\"#submit\");\n    var token = $('meta[name=\"csrf_token\"]').attr('content')\n    $submitButton.hide();\n\n    $('#file-upload').change(function(event) {\n        $submitButton.show();\n    });\n    $('.delete-recording').click(function(event) {\n        event.preventDefault();\n        var id = $(this).data('id');\n        var data = {_method: 'DELETE', '_token': token};\n        var $el = $('.recording-'+id);\n        $.ajax({\n            url: '/recordings/'+id,\n            type: 'POST',\n            dataType: 'json',\n            data: data,\n        })\n        .done(function(e) {\n            if(e.status > 200) {\n                $el.fadeTo(200, 0, function() {\n                 $(this).remove();   \n                });\n            }\n        })\n        .fail(function() {\n            console.log(\"error\");\n        })\n        .always(function() {\n            console.log(\"complete\");\n        });\n        \n    });\n    $form.submit(function( event ) {\n        event.preventDefault();\n        console.log(\"Post Recording\");\n        if(!currAudioBlob && $('#file-upload').val() == \"\") {\n            console.log(\"Missing recording\");\n            return;            \n        }\n        var data = new FormData($('form')[0]);\n        if(currAudioBlob) {\n            var blob = new Blob([currAudioBlob], {type: \"audio/wav\"});\n            data.append('audio_name', moment().format('x')+\"_audio.wav\");\n            data.append('audio_file', blob);\n        }\n        $.ajax({\n            url: '/submit',\n            type: 'POST',\n            dataType: 'json',\n            data: data,\n            processData: false,\n            contentType: false\n        })\n        .done(function(e) {\n            console.log(\"success\", e);\n            if(e.status > 200) {\n                document.location = '/';\n            }\n        })\n        .fail(function() {\n            console.log(\"error\");\n        })\n        .always(function() {\n            console.log(\"complete\");\n        });\n    });\n\n    // ------------------------------------------------------------------------\n    function startUserMedia(stream) {\n        var input = audio_context.createMediaStreamSource(stream);\n         __log('Media stream created.');\n\n        // Uncomment if you want the audio to feedback directly\n        //input.connect(audio_context.destination);\n        //__log('Input connected to audio context destination.');\n    \n        recorder = new Recorder(input);\n        __log('Recorder initialised.');\n    }\n\n    // ------------------------------------------------------------------------\n    try {\n        \n        // webkit shim\n        window.AudioContext = window.AudioContext || window.webkitAudioContext;\n        navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n        window.URL = window.URL || window.webkitURL;\n      \n        audio_context = new AudioContext;\n\n        __log('Audio context set up.');\n        __log('navigator.getUserMedia ' + (navigator.getUserMedia ? 'available.' : 'not present!'));\n    } catch (e) {\n        console.log(\"e: \", e)\n    }\n    \n    navigator.getUserMedia({audio: true}, startUserMedia, function(e) {\n        console.log('No live audio input: ', e);\n    });\n\n    // ------------------------------------------------------------------------\n    var isRecording = false;\n    var $recordButton = $('#recording');\n    $recordButton.click(function(event) {\n        event.preventDefault();\n        console.log(currAudioBlob);\n        // start recording\n        if(!isRecording) {\n            isRecording = true;\n            recorder && recorder.record();\n            __log('Recording...');\n            $(this).html(\"Stop Recording\");\n        }\n\n        // stop recording\n        else {\n            isRecording = false;   \n            $(this).html(currAudioBlob ? \"Re-Record\" : \"Start Recording\");\n            \n            // stop\n            recorder && recorder.stop();\n            __log('Stopped recording.');\n            if(currAudioBlob) {\n                $submitButton.show();\n            }\n            submitOrRerecord();\n        }\n    });\n\n    // ------------------------------------------------------------------------\n    function submitOrRerecord() {\n\n        recorder && recorder.exportWAV(function(blob) {\n\n            currAudioBlob = blob;\n            console.log(\"audio blob!\");\n\n            var sound_url = URL.createObjectURL(currAudioBlob);\n            var audio_elt = document.createElement('audio');\n            audio_elt.controls = true;\n            audio_elt.src = sound_url;\n            audio_elt.setAttribute('data-question', $(\".record\").attr('data-question'));\n\n\n            $('#recording-col').html( $(audio_elt) );\n            $recordButton.html(currAudioBlob ? \"Re-Record\" : \"Start Recording\");\n            if(currAudioBlob) {\n                $submitButton.show();\n            }\n            recorder.clear();\n        });\n  }\n\n});\n\n/*\n\n\n\n\n\n\n\n\n  function __log(e, data) {\n    console.log(e + \" \" + (data || ''));\n  }\n\n  var audio_context;\n  var recorder;\n  var recording=false;\n\n  function startUserMedia(stream) {\n    var input = audio_context.createMediaStreamSource(stream);\n    __log('Media stream created.');\n\n    // Uncomment if you want the audio to feedback directly\n    //input.connect(audio_context.destination);\n    //__log('Input connected to audio context destination.');\n    \n    recorder = new Recorder(input);\n    __log('Recorder initialised.');\n  }\n\nfunction toggleRecord(ev){\n    var btn = $(ev.target);\n    var spanverbiage = $(ev.target).parent().children('span').first();\n         if(btn.hasClass('notRec')){\n\n                 btn.removeClass(\"notRec\");\n                 btn.addClass(\"Rec\");\n                 // start recording now!\n                 spanverbiage.html(\"Stop\");\n                 recording = true;\n                 recorder && recorder.record();\n\n                 __log('Recording...');\n             } else {\n                 btn.removeClass(\"Rec\");\n                 btn.addClass(\"notRec\");\n\n                 spanverbiage.html(\"Re-Record\");\n\n                  // stop\n                 recording = false;\n                 recorder && recorder.stop();\n\n                 __log('Stopped recording.');\n                 // create WAV download link using audio data blob\n                 submitOrRerecord();\n\n             }\n\n     }\n     */\n\n/*\nvar Screensaver = require('./screensaver.js');\n\n$(function() {\n    /// dis nasty but trying to move fast here\n    var currAudioBlob;\n\n   //intro slide - only show 'let's go' when we're dang ready\n   var nameField = false\n   var emailField = false;\n   function testFields(keycode) { if (nameField && emailField) { \n    $(\".info button.hidden\").removeClass(\"hidden\");\n    if(keycode == 13) {\n        $.deck('next');\n    }\n    }}\n   $(\"#name-input\").keyup(function(){\n    nameField = true;\n    testFields(e.keyCode);\n   });\n   $(\"#email-input\").keyup(function(e){\n    emailField = true;\n    testFields(e.keyCode);\n   });\n   $(document).keyup(function(e) {\n     if(e.keyCode == 27) {\n        $(\"#terms\").addClass(\"hidden\");\n     }\n   })\n\n\n  \n\n    \n    $(document).bind('deck.change', function(event, from, to) {\n\t   console.log('Moving from slide ' + from + ' to ' + to);\n\n        // submit full data packets on the 'thanks' slide\n        if( $(\".deck-next\").hasClass('thanks')) {\n            // attempt to submit data\n            var question_attr = $(\".thanks.deck-next\").attr(\"data-question\");\n\n            var audio_blob = currAudioBlob;//$(\"audio[data-question='\"+question_attr+\"'\").attr('src');\n\n\n\n            var dataPacket = new FormData();\n\n            dataPacket.append('question', $(\".question[data-question='\"+question_attr+\"'] p.question-str\").html());\n            dataPacket.append('question_id', question_attr.substring(8,9));\n\n            var response = $(\"#\"+question_attr).val();\n            if (response == undefined) { response = '50'; }\n            dataPacket.append('response', response);\n\n\n            var question_care = $(\"#\"+question_attr+\"_care\").val();\n            if (question_care == undefined) { question_care = '50'; }            \n            dataPacket.append('strength', question_care);\n\n\n            dataPacket.append('csrf_token', $('meta[name=\"csrf_token\"]').attr('content'));\n            var name = ($(\"#name-input\").val().length == 0) ? \"No name given\" : $(\"#name-input\").val();\n            dataPacket.append('name', name);\n            var email = ($(\"#email-input\").val().length == 0) ? \"No@email.address\" : $(\"#email-input\").val();\n            dataPacket.append('email', email);\n            console.log(audio_blob);\n            dataPacket.append('audio_name', moment().format('x')+\"_audio.wav\");\n            dataPacket.append('audio_file', audio_blob);\n\n            // var dataPacket = {\n            //     'timestamp': moment().format('MM/DD/YYYY HH:mm:ss a'),\n            //     'question': $(\".question[data-question='\"+question_attr+\"'] p.question-str\").html(),\n            //     'question_id': question_attr.substring(8,9),\n            //     'response': $(\"#\"+question_attr).val(),\n            //     'strength': $(\"#\"+question_attr+\"_care\").val(),\n            //     'audio_file': audio_blob,\n            //     'name': $(\"#name-input\").val(),\n            //     'email': $(\"#email-input\").val()\n            // };\n\n            console.log(dataPacket);\n\n\n            $.ajax({\n                url: '/submit',\n                type: 'POST',\n                dataType: 'json',\n                data: dataPacket,\n                processData: false,\n                contentType: false\n               \n            })\n            .done(function(data, status, xhr) {\n                console.log(\"SUCCESS\");\n                console.log(\"data\", data);\n                console.log(\"status\", status);\n                console.log(\"xhr\", xhr);\n                console.log(\"-----------\");\n            })\n            .fail(function() {\n                console.log(\"error\");\n            })\n            .always(function(xhr, status) {\n                console.log(\"COMPLETE\");\n                console.log(\"status\", status);\n                console.log(\"xhr\", xhr);\n                console.log(\"-----------\");\n            });\n\n\n    \n        }\n\n\n        if( $(\".deck-next\").hasClass('autoplay')) {\n            setTimeout(function(){\n                if ( $(\".deck-current\").hasClass('autoplay') ){\n                    $.deck('next'); \n                }\n            }, 1200);\n        }\n\n        if( $(\".deck-next\").hasClass('done')) {\n            setTimeout(function(){\n                if ( $(\".deck-current\").hasClass('done') ){\n                    \n                    window.location.href = \"/\";\n                }\n            }, 5200);\n        }\n\n\t});\n\n\n\n    //todo - turn off arrow listeners on slideshow\n    //todo - hammerjs that ish\n\n\n    /////////////\n    // record stuff\n    /////////\n\n    try {\n      // webkit shim\n      window.AudioContext = window.AudioContext || window.webkitAudioContext;\n      navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia;\n      window.URL = window.URL || window.webkitURL;\n      \n      audio_context = new AudioContext;\n\n      __log('Audio context set up.');\n      __log('navigator.getUserMedia ' + (navigator.getUserMedia ? 'available.' : 'not present!'));\n    } catch (e) {\n        console.log(\"e: \", e)\n    }\n    \n    navigator.getUserMedia({audio: true}, startUserMedia, function(e) {\n      console.log('No live audio input: ', e);\n    });\n\n\n\n\n\n\n  function __log(e, data) {\n    console.log(e + \" \" + (data || ''));\n  }\n\n  var audio_context;\n  var recorder;\n  var recording=false;\n\n  function startUserMedia(stream) {\n    var input = audio_context.createMediaStreamSource(stream);\n    __log('Media stream created.');\n\n    // Uncomment if you want the audio to feedback directly\n    //input.connect(audio_context.destination);\n    //__log('Input connected to audio context destination.');\n    \n    recorder = new Recorder(input);\n    __log('Recorder initialised.');\n  }\n\nfunction toggleRecord(ev){\n    var btn = $(ev.target);\n    var spanverbiage = $(ev.target).parent().children('span').first();\n         if(btn.hasClass('notRec')){\n\n                 btn.removeClass(\"notRec\");\n                 btn.addClass(\"Rec\");\n                 // start recording now!\n                 spanverbiage.html(\"Stop\");\n                 recording = true;\n                 recorder && recorder.record();\n\n                 __log('Recording...');\n             } else {\n                 btn.removeClass(\"Rec\");\n                 btn.addClass(\"notRec\");\n\n                 spanverbiage.html(\"Re-Record\");\n\n                  // stop\n                 recording = false;\n                 recorder && recorder.stop();\n\n                 __log('Stopped recording.');\n                 // create WAV download link using audio data blob\n                 submitOrRerecord();\n\n             }\n\n     }\n\n  //  var recordButton = $('.recorder-button button');\n   //   // record button clickers\n     // recordButton.each(function(){\n     //     var $this = $(this);\n     //     var $spanVerbiage = $(this).parent().find('span').first();\n     //     var mc = new Hammer(this);\n     //     mc.on(\"tap\", function() {\n     //         if($this.hasClass('notRec')){\n\n     //             $this.removeClass(\"notRec\");\n     //             $this.addClass(\"Rec\");\n     //             // start recording now!\n     //             $spanVerbiage.html(\"Stop\");\n     //             recording = true;\n     //             recorder && recorder.record();\n\n     //             __log('Recording...');\n     //         } else {\n     //             $this.removeClass(\"Rec\");\n     //             $this.addClass(\"notRec\");\n\n     //             $spanVerbiage.html(\"Re-Record\");\n\n     //              // stop\n     //             recording = false;\n     //             recorder && recorder.stop();\n\n     //             __log('Stopped recording.');\n     //             // create WAV download link using audio data blob\n     //             submitOrRerecord();\n\n     //         }\n     //     });\n     // });\n\n\n\n  function submitOrRerecord() {\n    console.log(\"hey man!\");\n    console.log(recorder);\n\n    recorder && recorder.exportWAV(function(blob) {\n      currAudioBlob = blob;\n      console.log(\"audio blob!\");\n\n      var thisQuestion = $(\".record.deck-current\").attr('data-question');\n\n      var sound_url = URL.createObjectURL(currAudioBlob);\n      var audio_elt = document.createElement('audio');\n      audio_elt.controls = true;\n      audio_elt.src = sound_url;\n      audio_elt.setAttribute('data-question', $(\".record\").attr('data-question'));\n\n      console.log(thisQuestion);\n      var currQuestionsPlayer = $(\".record[data-question='\"+thisQuestion+\"'] .playMostRecent\");\n      currQuestionsPlayer.html(\"\");\n      currQuestionsPlayer.append( $(audio_elt) );\n     // currQuestionsPlayer.append($(audio_link));\n\n      currQuestionsPlayer.find(\"audio\").attr(\"data-question\", thisQuestion);\n\n\n      $(\".deck-current.record button.next\").removeClass(\"hidden\");\n\n        recorder.clear();\n\n    });\n  }\n\n\n\n\n});*///# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2FwcC5qcz84YjY3Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oJCkge1xuICAgIFxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgdmFyICRtZW51ID0gJCgnLnVzZXItZHJvcGRvd24tbWVudScpO1xuICAgICQoXCIudXNlci1pbWFnZVwiKS5jbGljayhmdW5jdGlvbihldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAkbWVudS50b2dnbGVDbGFzcygnb3BlbicpO1xuICAgIH0pO1xuXG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBmdW5jdGlvbiBfX2xvZyhlLCBkYXRhKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGUgKyBcIiBcIiArIChkYXRhIHx8ICcnKSk7XG4gICAgfVxuXG4gICAgdmFyIGF1ZGlvX2NvbnRleHQ7XG4gICAgdmFyIHJlY29yZGVyO1xuICAgIHZhciByZWNvcmRpbmcgPSBmYWxzZTtcbiAgICB2YXIgJGZvcm0gPSAkKCdmb3JtJyk7XG4gICAgdmFyIGN1cnJBdWRpb0Jsb2IgPSBudWxsO1xuICAgIHZhciAkZm9ybSA9ICQoXCJmb3JtXCIpO1xuICAgIHZhciAkc3VibWl0QnV0dG9uID0gJChcIiNzdWJtaXRcIik7XG4gICAgdmFyIHRva2VuID0gJCgnbWV0YVtuYW1lPVwiY3NyZl90b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKVxuICAgICRzdWJtaXRCdXR0b24uaGlkZSgpO1xuXG4gICAgJCgnI2ZpbGUtdXBsb2FkJykuY2hhbmdlKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICRzdWJtaXRCdXR0b24uc2hvdygpO1xuICAgIH0pO1xuICAgICQoJy5kZWxldGUtcmVjb3JkaW5nJykuY2xpY2soZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdmFyIGlkID0gJCh0aGlzKS5kYXRhKCdpZCcpO1xuICAgICAgICB2YXIgZGF0YSA9IHtfbWV0aG9kOiAnREVMRVRFJywgJ190b2tlbic6IHRva2VufTtcbiAgICAgICAgdmFyICRlbCA9ICQoJy5yZWNvcmRpbmctJytpZCk7XG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcvcmVjb3JkaW5ncy8nK2lkLFxuICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgIH0pXG4gICAgICAgIC5kb25lKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGlmKGUuc3RhdHVzID4gMjAwKSB7XG4gICAgICAgICAgICAgICAgJGVsLmZhZGVUbygyMDAsIDAsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZSgpOyAgIFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3JcIik7XG4gICAgICAgIH0pXG4gICAgICAgIC5hbHdheXMoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNvbXBsZXRlXCIpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgfSk7XG4gICAgJGZvcm0uc3VibWl0KGZ1bmN0aW9uKCBldmVudCApIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJQb3N0IFJlY29yZGluZ1wiKTtcbiAgICAgICAgaWYoIWN1cnJBdWRpb0Jsb2IgJiYgJCgnI2ZpbGUtdXBsb2FkJykudmFsKCkgPT0gXCJcIikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJNaXNzaW5nIHJlY29yZGluZ1wiKTtcbiAgICAgICAgICAgIHJldHVybjsgICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0YSA9IG5ldyBGb3JtRGF0YSgkKCdmb3JtJylbMF0pO1xuICAgICAgICBpZihjdXJyQXVkaW9CbG9iKSB7XG4gICAgICAgICAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtjdXJyQXVkaW9CbG9iXSwge3R5cGU6IFwiYXVkaW8vd2F2XCJ9KTtcbiAgICAgICAgICAgIGRhdGEuYXBwZW5kKCdhdWRpb19uYW1lJywgbW9tZW50KCkuZm9ybWF0KCd4JykrXCJfYXVkaW8ud2F2XCIpO1xuICAgICAgICAgICAgZGF0YS5hcHBlbmQoJ2F1ZGlvX2ZpbGUnLCBibG9iKTtcbiAgICAgICAgfVxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiAnL3N1Ym1pdCcsXG4gICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgIHByb2Nlc3NEYXRhOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBmYWxzZVxuICAgICAgICB9KVxuICAgICAgICAuZG9uZShmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInN1Y2Nlc3NcIiwgZSk7XG4gICAgICAgICAgICBpZihlLnN0YXR1cyA+IDIwMCkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmxvY2F0aW9uID0gJy8nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3JcIik7XG4gICAgICAgIH0pXG4gICAgICAgIC5hbHdheXMoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNvbXBsZXRlXCIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGZ1bmN0aW9uIHN0YXJ0VXNlck1lZGlhKHN0cmVhbSkge1xuICAgICAgICB2YXIgaW5wdXQgPSBhdWRpb19jb250ZXh0LmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHN0cmVhbSk7XG4gICAgICAgICBfX2xvZygnTWVkaWEgc3RyZWFtIGNyZWF0ZWQuJyk7XG5cbiAgICAgICAgLy8gVW5jb21tZW50IGlmIHlvdSB3YW50IHRoZSBhdWRpbyB0byBmZWVkYmFjayBkaXJlY3RseVxuICAgICAgICAvL2lucHV0LmNvbm5lY3QoYXVkaW9fY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgIC8vX19sb2coJ0lucHV0IGNvbm5lY3RlZCB0byBhdWRpbyBjb250ZXh0IGRlc3RpbmF0aW9uLicpO1xuICAgIFxuICAgICAgICByZWNvcmRlciA9IG5ldyBSZWNvcmRlcihpbnB1dCk7XG4gICAgICAgIF9fbG9nKCdSZWNvcmRlciBpbml0aWFsaXNlZC4nKTtcbiAgICB9XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICB0cnkge1xuICAgICAgICBcbiAgICAgICAgLy8gd2Via2l0IHNoaW1cbiAgICAgICAgd2luZG93LkF1ZGlvQ29udGV4dCA9IHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dDtcbiAgICAgICAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5nZXRVc2VyTWVkaWEgfHwgbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYSB8fCBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhO1xuICAgICAgICB3aW5kb3cuVVJMID0gd2luZG93LlVSTCB8fCB3aW5kb3cud2Via2l0VVJMO1xuICAgICAgXG4gICAgICAgIGF1ZGlvX2NvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0O1xuXG4gICAgICAgIF9fbG9nKCdBdWRpbyBjb250ZXh0IHNldCB1cC4nKTtcbiAgICAgICAgX19sb2coJ25hdmlnYXRvci5nZXRVc2VyTWVkaWEgJyArIChuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID8gJ2F2YWlsYWJsZS4nIDogJ25vdCBwcmVzZW50IScpKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZTogXCIsIGUpXG4gICAgfVxuICAgIFxuICAgIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEoe2F1ZGlvOiB0cnVlfSwgc3RhcnRVc2VyTWVkaWEsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ05vIGxpdmUgYXVkaW8gaW5wdXQ6ICcsIGUpO1xuICAgIH0pO1xuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgdmFyIGlzUmVjb3JkaW5nID0gZmFsc2U7XG4gICAgdmFyICRyZWNvcmRCdXR0b24gPSAkKCcjcmVjb3JkaW5nJyk7XG4gICAgJHJlY29yZEJ1dHRvbi5jbGljayhmdW5jdGlvbihldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zb2xlLmxvZyhjdXJyQXVkaW9CbG9iKTtcbiAgICAgICAgLy8gc3RhcnQgcmVjb3JkaW5nXG4gICAgICAgIGlmKCFpc1JlY29yZGluZykge1xuICAgICAgICAgICAgaXNSZWNvcmRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgcmVjb3JkZXIgJiYgcmVjb3JkZXIucmVjb3JkKCk7XG4gICAgICAgICAgICBfX2xvZygnUmVjb3JkaW5nLi4uJyk7XG4gICAgICAgICAgICAkKHRoaXMpLmh0bWwoXCJTdG9wIFJlY29yZGluZ1wiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHN0b3AgcmVjb3JkaW5nXG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaXNSZWNvcmRpbmcgPSBmYWxzZTsgICBcbiAgICAgICAgICAgICQodGhpcykuaHRtbChjdXJyQXVkaW9CbG9iID8gXCJSZS1SZWNvcmRcIiA6IFwiU3RhcnQgUmVjb3JkaW5nXCIpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBzdG9wXG4gICAgICAgICAgICByZWNvcmRlciAmJiByZWNvcmRlci5zdG9wKCk7XG4gICAgICAgICAgICBfX2xvZygnU3RvcHBlZCByZWNvcmRpbmcuJyk7XG4gICAgICAgICAgICBpZihjdXJyQXVkaW9CbG9iKSB7XG4gICAgICAgICAgICAgICAgJHN1Ym1pdEJ1dHRvbi5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdWJtaXRPclJlcmVjb3JkKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGZ1bmN0aW9uIHN1Ym1pdE9yUmVyZWNvcmQoKSB7XG5cbiAgICAgICAgcmVjb3JkZXIgJiYgcmVjb3JkZXIuZXhwb3J0V0FWKGZ1bmN0aW9uKGJsb2IpIHtcblxuICAgICAgICAgICAgY3VyckF1ZGlvQmxvYiA9IGJsb2I7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImF1ZGlvIGJsb2IhXCIpO1xuXG4gICAgICAgICAgICB2YXIgc291bmRfdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChjdXJyQXVkaW9CbG9iKTtcbiAgICAgICAgICAgIHZhciBhdWRpb19lbHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhdWRpbycpO1xuICAgICAgICAgICAgYXVkaW9fZWx0LmNvbnRyb2xzID0gdHJ1ZTtcbiAgICAgICAgICAgIGF1ZGlvX2VsdC5zcmMgPSBzb3VuZF91cmw7XG4gICAgICAgICAgICBhdWRpb19lbHQuc2V0QXR0cmlidXRlKCdkYXRhLXF1ZXN0aW9uJywgJChcIi5yZWNvcmRcIikuYXR0cignZGF0YS1xdWVzdGlvbicpKTtcblxuXG4gICAgICAgICAgICAkKCcjcmVjb3JkaW5nLWNvbCcpLmh0bWwoICQoYXVkaW9fZWx0KSApO1xuICAgICAgICAgICAgJHJlY29yZEJ1dHRvbi5odG1sKGN1cnJBdWRpb0Jsb2IgPyBcIlJlLVJlY29yZFwiIDogXCJTdGFydCBSZWNvcmRpbmdcIik7XG4gICAgICAgICAgICBpZihjdXJyQXVkaW9CbG9iKSB7XG4gICAgICAgICAgICAgICAgJHN1Ym1pdEJ1dHRvbi5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWNvcmRlci5jbGVhcigpO1xuICAgICAgICB9KTtcbiAgfVxuXG59KTtcblxuLypcblxuXG5cblxuXG5cblxuXG4gIGZ1bmN0aW9uIF9fbG9nKGUsIGRhdGEpIHtcbiAgICBjb25zb2xlLmxvZyhlICsgXCIgXCIgKyAoZGF0YSB8fCAnJykpO1xuICB9XG5cbiAgdmFyIGF1ZGlvX2NvbnRleHQ7XG4gIHZhciByZWNvcmRlcjtcbiAgdmFyIHJlY29yZGluZz1mYWxzZTtcblxuICBmdW5jdGlvbiBzdGFydFVzZXJNZWRpYShzdHJlYW0pIHtcbiAgICB2YXIgaW5wdXQgPSBhdWRpb19jb250ZXh0LmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHN0cmVhbSk7XG4gICAgX19sb2coJ01lZGlhIHN0cmVhbSBjcmVhdGVkLicpO1xuXG4gICAgLy8gVW5jb21tZW50IGlmIHlvdSB3YW50IHRoZSBhdWRpbyB0byBmZWVkYmFjayBkaXJlY3RseVxuICAgIC8vaW5wdXQuY29ubmVjdChhdWRpb19jb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICAvL19fbG9nKCdJbnB1dCBjb25uZWN0ZWQgdG8gYXVkaW8gY29udGV4dCBkZXN0aW5hdGlvbi4nKTtcbiAgICBcbiAgICByZWNvcmRlciA9IG5ldyBSZWNvcmRlcihpbnB1dCk7XG4gICAgX19sb2coJ1JlY29yZGVyIGluaXRpYWxpc2VkLicpO1xuICB9XG5cbmZ1bmN0aW9uIHRvZ2dsZVJlY29yZChldil7XG4gICAgdmFyIGJ0biA9ICQoZXYudGFyZ2V0KTtcbiAgICB2YXIgc3BhbnZlcmJpYWdlID0gJChldi50YXJnZXQpLnBhcmVudCgpLmNoaWxkcmVuKCdzcGFuJykuZmlyc3QoKTtcbiAgICAgICAgIGlmKGJ0bi5oYXNDbGFzcygnbm90UmVjJykpe1xuXG4gICAgICAgICAgICAgICAgIGJ0bi5yZW1vdmVDbGFzcyhcIm5vdFJlY1wiKTtcbiAgICAgICAgICAgICAgICAgYnRuLmFkZENsYXNzKFwiUmVjXCIpO1xuICAgICAgICAgICAgICAgICAvLyBzdGFydCByZWNvcmRpbmcgbm93IVxuICAgICAgICAgICAgICAgICBzcGFudmVyYmlhZ2UuaHRtbChcIlN0b3BcIik7XG4gICAgICAgICAgICAgICAgIHJlY29yZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgIHJlY29yZGVyICYmIHJlY29yZGVyLnJlY29yZCgpO1xuXG4gICAgICAgICAgICAgICAgIF9fbG9nKCdSZWNvcmRpbmcuLi4nKTtcbiAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICBidG4ucmVtb3ZlQ2xhc3MoXCJSZWNcIik7XG4gICAgICAgICAgICAgICAgIGJ0bi5hZGRDbGFzcyhcIm5vdFJlY1wiKTtcblxuICAgICAgICAgICAgICAgICBzcGFudmVyYmlhZ2UuaHRtbChcIlJlLVJlY29yZFwiKTtcblxuICAgICAgICAgICAgICAgICAgLy8gc3RvcFxuICAgICAgICAgICAgICAgICByZWNvcmRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgcmVjb3JkZXIgJiYgcmVjb3JkZXIuc3RvcCgpO1xuXG4gICAgICAgICAgICAgICAgIF9fbG9nKCdTdG9wcGVkIHJlY29yZGluZy4nKTtcbiAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIFdBViBkb3dubG9hZCBsaW5rIHVzaW5nIGF1ZGlvIGRhdGEgYmxvYlxuICAgICAgICAgICAgICAgICBzdWJtaXRPclJlcmVjb3JkKCk7XG5cbiAgICAgICAgICAgICB9XG5cbiAgICAgfVxuICAgICAqL1xuXG4vKlxudmFyIFNjcmVlbnNhdmVyID0gcmVxdWlyZSgnLi9zY3JlZW5zYXZlci5qcycpO1xuXG4kKGZ1bmN0aW9uKCkge1xuICAgIC8vLyBkaXMgbmFzdHkgYnV0IHRyeWluZyB0byBtb3ZlIGZhc3QgaGVyZVxuICAgIHZhciBjdXJyQXVkaW9CbG9iO1xuXG4gICAvL2ludHJvIHNsaWRlIC0gb25seSBzaG93ICdsZXQncyBnbycgd2hlbiB3ZSdyZSBkYW5nIHJlYWR5XG4gICB2YXIgbmFtZUZpZWxkID0gZmFsc2VcbiAgIHZhciBlbWFpbEZpZWxkID0gZmFsc2U7XG4gICBmdW5jdGlvbiB0ZXN0RmllbGRzKGtleWNvZGUpIHsgaWYgKG5hbWVGaWVsZCAmJiBlbWFpbEZpZWxkKSB7IFxuICAgICQoXCIuaW5mbyBidXR0b24uaGlkZGVuXCIpLnJlbW92ZUNsYXNzKFwiaGlkZGVuXCIpO1xuICAgIGlmKGtleWNvZGUgPT0gMTMpIHtcbiAgICAgICAgJC5kZWNrKCduZXh0Jyk7XG4gICAgfVxuICAgIH19XG4gICAkKFwiI25hbWUtaW5wdXRcIikua2V5dXAoZnVuY3Rpb24oKXtcbiAgICBuYW1lRmllbGQgPSB0cnVlO1xuICAgIHRlc3RGaWVsZHMoZS5rZXlDb2RlKTtcbiAgIH0pO1xuICAgJChcIiNlbWFpbC1pbnB1dFwiKS5rZXl1cChmdW5jdGlvbihlKXtcbiAgICBlbWFpbEZpZWxkID0gdHJ1ZTtcbiAgICB0ZXN0RmllbGRzKGUua2V5Q29kZSk7XG4gICB9KTtcbiAgICQoZG9jdW1lbnQpLmtleXVwKGZ1bmN0aW9uKGUpIHtcbiAgICAgaWYoZS5rZXlDb2RlID09IDI3KSB7XG4gICAgICAgICQoXCIjdGVybXNcIikuYWRkQ2xhc3MoXCJoaWRkZW5cIik7XG4gICAgIH1cbiAgIH0pXG5cblxuICBcblxuICAgIFxuICAgICQoZG9jdW1lbnQpLmJpbmQoJ2RlY2suY2hhbmdlJywgZnVuY3Rpb24oZXZlbnQsIGZyb20sIHRvKSB7XG5cdCAgIGNvbnNvbGUubG9nKCdNb3ZpbmcgZnJvbSBzbGlkZSAnICsgZnJvbSArICcgdG8gJyArIHRvKTtcblxuICAgICAgICAvLyBzdWJtaXQgZnVsbCBkYXRhIHBhY2tldHMgb24gdGhlICd0aGFua3MnIHNsaWRlXG4gICAgICAgIGlmKCAkKFwiLmRlY2stbmV4dFwiKS5oYXNDbGFzcygndGhhbmtzJykpIHtcbiAgICAgICAgICAgIC8vIGF0dGVtcHQgdG8gc3VibWl0IGRhdGFcbiAgICAgICAgICAgIHZhciBxdWVzdGlvbl9hdHRyID0gJChcIi50aGFua3MuZGVjay1uZXh0XCIpLmF0dHIoXCJkYXRhLXF1ZXN0aW9uXCIpO1xuXG4gICAgICAgICAgICB2YXIgYXVkaW9fYmxvYiA9IGN1cnJBdWRpb0Jsb2I7Ly8kKFwiYXVkaW9bZGF0YS1xdWVzdGlvbj0nXCIrcXVlc3Rpb25fYXR0citcIidcIikuYXR0cignc3JjJyk7XG5cblxuXG4gICAgICAgICAgICB2YXIgZGF0YVBhY2tldCA9IG5ldyBGb3JtRGF0YSgpO1xuXG4gICAgICAgICAgICBkYXRhUGFja2V0LmFwcGVuZCgncXVlc3Rpb24nLCAkKFwiLnF1ZXN0aW9uW2RhdGEtcXVlc3Rpb249J1wiK3F1ZXN0aW9uX2F0dHIrXCInXSBwLnF1ZXN0aW9uLXN0clwiKS5odG1sKCkpO1xuICAgICAgICAgICAgZGF0YVBhY2tldC5hcHBlbmQoJ3F1ZXN0aW9uX2lkJywgcXVlc3Rpb25fYXR0ci5zdWJzdHJpbmcoOCw5KSk7XG5cbiAgICAgICAgICAgIHZhciByZXNwb25zZSA9ICQoXCIjXCIrcXVlc3Rpb25fYXR0cikudmFsKCk7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UgPT0gdW5kZWZpbmVkKSB7IHJlc3BvbnNlID0gJzUwJzsgfVxuICAgICAgICAgICAgZGF0YVBhY2tldC5hcHBlbmQoJ3Jlc3BvbnNlJywgcmVzcG9uc2UpO1xuXG5cbiAgICAgICAgICAgIHZhciBxdWVzdGlvbl9jYXJlID0gJChcIiNcIitxdWVzdGlvbl9hdHRyK1wiX2NhcmVcIikudmFsKCk7XG4gICAgICAgICAgICBpZiAocXVlc3Rpb25fY2FyZSA9PSB1bmRlZmluZWQpIHsgcXVlc3Rpb25fY2FyZSA9ICc1MCc7IH0gICAgICAgICAgICBcbiAgICAgICAgICAgIGRhdGFQYWNrZXQuYXBwZW5kKCdzdHJlbmd0aCcsIHF1ZXN0aW9uX2NhcmUpO1xuXG5cbiAgICAgICAgICAgIGRhdGFQYWNrZXQuYXBwZW5kKCdjc3JmX3Rva2VuJywgJCgnbWV0YVtuYW1lPVwiY3NyZl90b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKSk7XG4gICAgICAgICAgICB2YXIgbmFtZSA9ICgkKFwiI25hbWUtaW5wdXRcIikudmFsKCkubGVuZ3RoID09IDApID8gXCJObyBuYW1lIGdpdmVuXCIgOiAkKFwiI25hbWUtaW5wdXRcIikudmFsKCk7XG4gICAgICAgICAgICBkYXRhUGFja2V0LmFwcGVuZCgnbmFtZScsIG5hbWUpO1xuICAgICAgICAgICAgdmFyIGVtYWlsID0gKCQoXCIjZW1haWwtaW5wdXRcIikudmFsKCkubGVuZ3RoID09IDApID8gXCJOb0BlbWFpbC5hZGRyZXNzXCIgOiAkKFwiI2VtYWlsLWlucHV0XCIpLnZhbCgpO1xuICAgICAgICAgICAgZGF0YVBhY2tldC5hcHBlbmQoJ2VtYWlsJywgZW1haWwpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYXVkaW9fYmxvYik7XG4gICAgICAgICAgICBkYXRhUGFja2V0LmFwcGVuZCgnYXVkaW9fbmFtZScsIG1vbWVudCgpLmZvcm1hdCgneCcpK1wiX2F1ZGlvLndhdlwiKTtcbiAgICAgICAgICAgIGRhdGFQYWNrZXQuYXBwZW5kKCdhdWRpb19maWxlJywgYXVkaW9fYmxvYik7XG5cbiAgICAgICAgICAgIC8vIHZhciBkYXRhUGFja2V0ID0ge1xuICAgICAgICAgICAgLy8gICAgICd0aW1lc3RhbXAnOiBtb21lbnQoKS5mb3JtYXQoJ01NL0REL1lZWVkgSEg6bW06c3MgYScpLFxuICAgICAgICAgICAgLy8gICAgICdxdWVzdGlvbic6ICQoXCIucXVlc3Rpb25bZGF0YS1xdWVzdGlvbj0nXCIrcXVlc3Rpb25fYXR0citcIiddIHAucXVlc3Rpb24tc3RyXCIpLmh0bWwoKSxcbiAgICAgICAgICAgIC8vICAgICAncXVlc3Rpb25faWQnOiBxdWVzdGlvbl9hdHRyLnN1YnN0cmluZyg4LDkpLFxuICAgICAgICAgICAgLy8gICAgICdyZXNwb25zZSc6ICQoXCIjXCIrcXVlc3Rpb25fYXR0cikudmFsKCksXG4gICAgICAgICAgICAvLyAgICAgJ3N0cmVuZ3RoJzogJChcIiNcIitxdWVzdGlvbl9hdHRyK1wiX2NhcmVcIikudmFsKCksXG4gICAgICAgICAgICAvLyAgICAgJ2F1ZGlvX2ZpbGUnOiBhdWRpb19ibG9iLFxuICAgICAgICAgICAgLy8gICAgICduYW1lJzogJChcIiNuYW1lLWlucHV0XCIpLnZhbCgpLFxuICAgICAgICAgICAgLy8gICAgICdlbWFpbCc6ICQoXCIjZW1haWwtaW5wdXRcIikudmFsKClcbiAgICAgICAgICAgIC8vIH07XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGFQYWNrZXQpO1xuXG5cbiAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3N1Ym1pdCcsXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YVBhY2tldCxcbiAgICAgICAgICAgICAgICBwcm9jZXNzRGF0YTogZmFsc2UsXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6IGZhbHNlXG4gICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhLCBzdGF0dXMsIHhocikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU1VDQ0VTU1wiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImRhdGFcIiwgZGF0YSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzdGF0dXNcIiwgc3RhdHVzKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInhoclwiLCB4aHIpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiLS0tLS0tLS0tLS1cIik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlcnJvclwiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYWx3YXlzKGZ1bmN0aW9uKHhociwgc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDT01QTEVURVwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInN0YXR1c1wiLCBzdGF0dXMpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwieGhyXCIsIHhocik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCItLS0tLS0tLS0tLVwiKTtcbiAgICAgICAgICAgIH0pO1xuXG5cbiAgICBcbiAgICAgICAgfVxuXG5cbiAgICAgICAgaWYoICQoXCIuZGVjay1uZXh0XCIpLmhhc0NsYXNzKCdhdXRvcGxheScpKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKCAkKFwiLmRlY2stY3VycmVudFwiKS5oYXNDbGFzcygnYXV0b3BsYXknKSApe1xuICAgICAgICAgICAgICAgICAgICAkLmRlY2soJ25leHQnKTsgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTIwMCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiggJChcIi5kZWNrLW5leHRcIikuaGFzQ2xhc3MoJ2RvbmUnKSkge1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGlmICggJChcIi5kZWNrLWN1cnJlbnRcIikuaGFzQ2xhc3MoJ2RvbmUnKSApe1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIi9cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCA1MjAwKTtcbiAgICAgICAgfVxuXG5cdH0pO1xuXG5cblxuICAgIC8vdG9kbyAtIHR1cm4gb2ZmIGFycm93IGxpc3RlbmVycyBvbiBzbGlkZXNob3dcbiAgICAvL3RvZG8gLSBoYW1tZXJqcyB0aGF0IGlzaFxuXG5cbiAgICAvLy8vLy8vLy8vLy8vXG4gICAgLy8gcmVjb3JkIHN0dWZmXG4gICAgLy8vLy8vLy8vXG5cbiAgICB0cnkge1xuICAgICAgLy8gd2Via2l0IHNoaW1cbiAgICAgIHdpbmRvdy5BdWRpb0NvbnRleHQgPSB3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQ7XG4gICAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLmdldFVzZXJNZWRpYSB8fCBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhO1xuICAgICAgd2luZG93LlVSTCA9IHdpbmRvdy5VUkwgfHwgd2luZG93LndlYmtpdFVSTDtcbiAgICAgIFxuICAgICAgYXVkaW9fY29udGV4dCA9IG5ldyBBdWRpb0NvbnRleHQ7XG5cbiAgICAgIF9fbG9nKCdBdWRpbyBjb250ZXh0IHNldCB1cC4nKTtcbiAgICAgIF9fbG9nKCduYXZpZ2F0b3IuZ2V0VXNlck1lZGlhICcgKyAobmF2aWdhdG9yLmdldFVzZXJNZWRpYSA/ICdhdmFpbGFibGUuJyA6ICdub3QgcHJlc2VudCEnKSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImU6IFwiLCBlKVxuICAgIH1cbiAgICBcbiAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhKHthdWRpbzogdHJ1ZX0sIHN0YXJ0VXNlck1lZGlhLCBmdW5jdGlvbihlKSB7XG4gICAgICBjb25zb2xlLmxvZygnTm8gbGl2ZSBhdWRpbyBpbnB1dDogJywgZSk7XG4gICAgfSk7XG5cblxuXG5cblxuXG4gIGZ1bmN0aW9uIF9fbG9nKGUsIGRhdGEpIHtcbiAgICBjb25zb2xlLmxvZyhlICsgXCIgXCIgKyAoZGF0YSB8fCAnJykpO1xuICB9XG5cbiAgdmFyIGF1ZGlvX2NvbnRleHQ7XG4gIHZhciByZWNvcmRlcjtcbiAgdmFyIHJlY29yZGluZz1mYWxzZTtcblxuICBmdW5jdGlvbiBzdGFydFVzZXJNZWRpYShzdHJlYW0pIHtcbiAgICB2YXIgaW5wdXQgPSBhdWRpb19jb250ZXh0LmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHN0cmVhbSk7XG4gICAgX19sb2coJ01lZGlhIHN0cmVhbSBjcmVhdGVkLicpO1xuXG4gICAgLy8gVW5jb21tZW50IGlmIHlvdSB3YW50IHRoZSBhdWRpbyB0byBmZWVkYmFjayBkaXJlY3RseVxuICAgIC8vaW5wdXQuY29ubmVjdChhdWRpb19jb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICAvL19fbG9nKCdJbnB1dCBjb25uZWN0ZWQgdG8gYXVkaW8gY29udGV4dCBkZXN0aW5hdGlvbi4nKTtcbiAgICBcbiAgICByZWNvcmRlciA9IG5ldyBSZWNvcmRlcihpbnB1dCk7XG4gICAgX19sb2coJ1JlY29yZGVyIGluaXRpYWxpc2VkLicpO1xuICB9XG5cbmZ1bmN0aW9uIHRvZ2dsZVJlY29yZChldil7XG4gICAgdmFyIGJ0biA9ICQoZXYudGFyZ2V0KTtcbiAgICB2YXIgc3BhbnZlcmJpYWdlID0gJChldi50YXJnZXQpLnBhcmVudCgpLmNoaWxkcmVuKCdzcGFuJykuZmlyc3QoKTtcbiAgICAgICAgIGlmKGJ0bi5oYXNDbGFzcygnbm90UmVjJykpe1xuXG4gICAgICAgICAgICAgICAgIGJ0bi5yZW1vdmVDbGFzcyhcIm5vdFJlY1wiKTtcbiAgICAgICAgICAgICAgICAgYnRuLmFkZENsYXNzKFwiUmVjXCIpO1xuICAgICAgICAgICAgICAgICAvLyBzdGFydCByZWNvcmRpbmcgbm93IVxuICAgICAgICAgICAgICAgICBzcGFudmVyYmlhZ2UuaHRtbChcIlN0b3BcIik7XG4gICAgICAgICAgICAgICAgIHJlY29yZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgIHJlY29yZGVyICYmIHJlY29yZGVyLnJlY29yZCgpO1xuXG4gICAgICAgICAgICAgICAgIF9fbG9nKCdSZWNvcmRpbmcuLi4nKTtcbiAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICBidG4ucmVtb3ZlQ2xhc3MoXCJSZWNcIik7XG4gICAgICAgICAgICAgICAgIGJ0bi5hZGRDbGFzcyhcIm5vdFJlY1wiKTtcblxuICAgICAgICAgICAgICAgICBzcGFudmVyYmlhZ2UuaHRtbChcIlJlLVJlY29yZFwiKTtcblxuICAgICAgICAgICAgICAgICAgLy8gc3RvcFxuICAgICAgICAgICAgICAgICByZWNvcmRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgcmVjb3JkZXIgJiYgcmVjb3JkZXIuc3RvcCgpO1xuXG4gICAgICAgICAgICAgICAgIF9fbG9nKCdTdG9wcGVkIHJlY29yZGluZy4nKTtcbiAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIFdBViBkb3dubG9hZCBsaW5rIHVzaW5nIGF1ZGlvIGRhdGEgYmxvYlxuICAgICAgICAgICAgICAgICBzdWJtaXRPclJlcmVjb3JkKCk7XG5cbiAgICAgICAgICAgICB9XG5cbiAgICAgfVxuXG4gIC8vICB2YXIgcmVjb3JkQnV0dG9uID0gJCgnLnJlY29yZGVyLWJ1dHRvbiBidXR0b24nKTtcbiAgIC8vICAgLy8gcmVjb3JkIGJ1dHRvbiBjbGlja2Vyc1xuICAgICAvLyByZWNvcmRCdXR0b24uZWFjaChmdW5jdGlvbigpe1xuICAgICAvLyAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcbiAgICAgLy8gICAgIHZhciAkc3BhblZlcmJpYWdlID0gJCh0aGlzKS5wYXJlbnQoKS5maW5kKCdzcGFuJykuZmlyc3QoKTtcbiAgICAgLy8gICAgIHZhciBtYyA9IG5ldyBIYW1tZXIodGhpcyk7XG4gICAgIC8vICAgICBtYy5vbihcInRhcFwiLCBmdW5jdGlvbigpIHtcbiAgICAgLy8gICAgICAgICBpZigkdGhpcy5oYXNDbGFzcygnbm90UmVjJykpe1xuXG4gICAgIC8vICAgICAgICAgICAgICR0aGlzLnJlbW92ZUNsYXNzKFwibm90UmVjXCIpO1xuICAgICAvLyAgICAgICAgICAgICAkdGhpcy5hZGRDbGFzcyhcIlJlY1wiKTtcbiAgICAgLy8gICAgICAgICAgICAgLy8gc3RhcnQgcmVjb3JkaW5nIG5vdyFcbiAgICAgLy8gICAgICAgICAgICAgJHNwYW5WZXJiaWFnZS5odG1sKFwiU3RvcFwiKTtcbiAgICAgLy8gICAgICAgICAgICAgcmVjb3JkaW5nID0gdHJ1ZTtcbiAgICAgLy8gICAgICAgICAgICAgcmVjb3JkZXIgJiYgcmVjb3JkZXIucmVjb3JkKCk7XG5cbiAgICAgLy8gICAgICAgICAgICAgX19sb2coJ1JlY29yZGluZy4uLicpO1xuICAgICAvLyAgICAgICAgIH0gZWxzZSB7XG4gICAgIC8vICAgICAgICAgICAgICR0aGlzLnJlbW92ZUNsYXNzKFwiUmVjXCIpO1xuICAgICAvLyAgICAgICAgICAgICAkdGhpcy5hZGRDbGFzcyhcIm5vdFJlY1wiKTtcblxuICAgICAvLyAgICAgICAgICAgICAkc3BhblZlcmJpYWdlLmh0bWwoXCJSZS1SZWNvcmRcIik7XG5cbiAgICAgLy8gICAgICAgICAgICAgIC8vIHN0b3BcbiAgICAgLy8gICAgICAgICAgICAgcmVjb3JkaW5nID0gZmFsc2U7XG4gICAgIC8vICAgICAgICAgICAgIHJlY29yZGVyICYmIHJlY29yZGVyLnN0b3AoKTtcblxuICAgICAvLyAgICAgICAgICAgICBfX2xvZygnU3RvcHBlZCByZWNvcmRpbmcuJyk7XG4gICAgIC8vICAgICAgICAgICAgIC8vIGNyZWF0ZSBXQVYgZG93bmxvYWQgbGluayB1c2luZyBhdWRpbyBkYXRhIGJsb2JcbiAgICAgLy8gICAgICAgICAgICAgc3VibWl0T3JSZXJlY29yZCgpO1xuXG4gICAgIC8vICAgICAgICAgfVxuICAgICAvLyAgICAgfSk7XG4gICAgIC8vIH0pO1xuXG5cblxuICBmdW5jdGlvbiBzdWJtaXRPclJlcmVjb3JkKCkge1xuICAgIGNvbnNvbGUubG9nKFwiaGV5IG1hbiFcIik7XG4gICAgY29uc29sZS5sb2cocmVjb3JkZXIpO1xuXG4gICAgcmVjb3JkZXIgJiYgcmVjb3JkZXIuZXhwb3J0V0FWKGZ1bmN0aW9uKGJsb2IpIHtcbiAgICAgIGN1cnJBdWRpb0Jsb2IgPSBibG9iO1xuICAgICAgY29uc29sZS5sb2coXCJhdWRpbyBibG9iIVwiKTtcblxuICAgICAgdmFyIHRoaXNRdWVzdGlvbiA9ICQoXCIucmVjb3JkLmRlY2stY3VycmVudFwiKS5hdHRyKCdkYXRhLXF1ZXN0aW9uJyk7XG5cbiAgICAgIHZhciBzb3VuZF91cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGN1cnJBdWRpb0Jsb2IpO1xuICAgICAgdmFyIGF1ZGlvX2VsdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2F1ZGlvJyk7XG4gICAgICBhdWRpb19lbHQuY29udHJvbHMgPSB0cnVlO1xuICAgICAgYXVkaW9fZWx0LnNyYyA9IHNvdW5kX3VybDtcbiAgICAgIGF1ZGlvX2VsdC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcXVlc3Rpb24nLCAkKFwiLnJlY29yZFwiKS5hdHRyKCdkYXRhLXF1ZXN0aW9uJykpO1xuXG4gICAgICBjb25zb2xlLmxvZyh0aGlzUXVlc3Rpb24pO1xuICAgICAgdmFyIGN1cnJRdWVzdGlvbnNQbGF5ZXIgPSAkKFwiLnJlY29yZFtkYXRhLXF1ZXN0aW9uPSdcIit0aGlzUXVlc3Rpb24rXCInXSAucGxheU1vc3RSZWNlbnRcIik7XG4gICAgICBjdXJyUXVlc3Rpb25zUGxheWVyLmh0bWwoXCJcIik7XG4gICAgICBjdXJyUXVlc3Rpb25zUGxheWVyLmFwcGVuZCggJChhdWRpb19lbHQpICk7XG4gICAgIC8vIGN1cnJRdWVzdGlvbnNQbGF5ZXIuYXBwZW5kKCQoYXVkaW9fbGluaykpO1xuXG4gICAgICBjdXJyUXVlc3Rpb25zUGxheWVyLmZpbmQoXCJhdWRpb1wiKS5hdHRyKFwiZGF0YS1xdWVzdGlvblwiLCB0aGlzUXVlc3Rpb24pO1xuXG5cbiAgICAgICQoXCIuZGVjay1jdXJyZW50LnJlY29yZCBidXR0b24ubmV4dFwiKS5yZW1vdmVDbGFzcyhcImhpZGRlblwiKTtcblxuICAgICAgICByZWNvcmRlci5jbGVhcigpO1xuXG4gICAgfSk7XG4gIH1cblxuXG5cblxufSk7Ki9cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gcmVzb3VyY2VzL2Fzc2V0cy9qcy9hcHAuanMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Iiwic291cmNlUm9vdCI6IiJ9");

/***/ }
/******/ ]);