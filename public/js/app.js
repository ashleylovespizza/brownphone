/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.l = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// identity function for calling harmory imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };

/******/ 	// define getter function for harmory exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		Object.defineProperty(exports, name, {
/******/ 			configurable: false,
/******/ 			enumerable: true,
/******/ 			get: getter
/******/ 		});
/******/ 	};

/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};

/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

"use strict";
eval("'use strict';\n\n$(document).ready(function($) {\n    \n\n    // ------------------------------------------------------------------------\n    var $menu = $('.user-dropdown-menu');\n    $(\".user-image\").click(function(event) {\n        event.preventDefault();\n        $menu.toggleClass('open');\n    });\n\n\n    // ------------------------------------------------------------------------\n    function __log(e, data) {\n        console.log(e + \" \" + (data || ''));\n    }\n\n    var audio_context;\n    var recorder;\n    var recording = false;\n    var $form = $('form');\n    var currAudioBlob = null;\n    var $form = $(\"form\");\n    var $submitButton = $(\"#submit\");\n    var token = $('meta[name=\"csrf_token\"]').attr('content')\n    $submitButton.hide();\n\n    $('#file-upload').change(function(event) {\n        $submitButton.show();\n    });\n    $('.delete-recording').click(function(event) {\n        event.preventDefault();\n        var id = $(this).data('id');\n        var data = {_method: 'DELETE', '_token': token};\n        var $el = $('.recording-'+id);\n        $.ajax({\n            url: '/recordings/'+id,\n            type: 'POST',\n            dataType: 'json',\n            data: data,\n        })\n        .done(function(e) {\n            if(e.status > 200) {\n                $el.fadeTo(200, 0, function() {\n                 $(this).remove();   \n                });\n            }\n        })\n        .fail(function() {\n            console.log(\"error\");\n        })\n        .always(function() {\n            console.log(\"complete\");\n        });\n        \n    });\n    $form.submit(function( event ) {\n        event.preventDefault();\n        console.log(\"Post Recording\");\n        if(!currAudioBlob && $('#file-upload').val() == \"\") {\n            console.log(\"Missing recording\");\n            return;            \n        }\n        var data = new FormData($('form')[0]);\n        if(currAudioBlob) {\n            var blob = new Blob([currAudioBlob], {type: \"audio/wav\"});\n            data.append('audio_name', moment().format('x')+\"_audio.wav\");\n            data.append('audio_file', blob);\n        }\n        $.ajax({\n            url: '/submit',\n            type: 'POST',\n            dataType: 'json',\n            data: data,\n            processData: false,\n            contentType: false\n        })\n        .done(function(e) {\n            console.log(\"success\", e);\n            if(e.status > 200) {\n                document.location = '/';\n            }\n        })\n        .fail(function() {\n            console.log(\"error\");\n        })\n        .always(function() {\n            console.log(\"complete\");\n        });\n    });\n\n    // ------------------------------------------------------------------------\n    function startUserMedia(stream) {\n        var input = audio_context.createMediaStreamSource(stream);\n         __log('Media stream created.');\n\n        // Uncomment if you want the audio to feedback directly\n        //input.connect(audio_context.destination);\n        //__log('Input connected to audio context destination.');\n    \n        recorder = new Recorder(input);\n        __log('Recorder initialised.');\n    }\n\n    // ------------------------------------------------------------------------\n    try {\n        \n        // webkit shim\n        window.AudioContext = window.AudioContext || window.webkitAudioContext;\n        navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia;\n        window.URL = window.URL || window.webkitURL;\n      \n        audio_context = new AudioContext;\n\n        __log('Audio context set up.');\n        __log('navigator.getUserMedia ' + (navigator.getUserMedia ? 'available.' : 'not present!'));\n    } catch (e) {\n        console.log(\"e: \", e)\n    }\n    \n    navigator.getUserMedia({audio: true}, startUserMedia, function(e) {\n        console.log('No live audio input: ', e);\n    });\n\n    // ------------------------------------------------------------------------\n    var isRecording = false;\n    var $recordButton = $('#recording');\n    $recordButton.click(function(event) {\n        event.preventDefault();\n        console.log(currAudioBlob);\n        // start recording\n        if(!isRecording) {\n            isRecording = true;\n            recorder && recorder.record();\n            __log('Recording...');\n            $(this).html(\"Stop Recording\");\n        }\n\n        // stop recording\n        else {\n            isRecording = false;   \n            $(this).html(currAudioBlob ? \"Re-Record\" : \"Start Recording\");\n            \n            // stop\n            recorder && recorder.stop();\n            __log('Stopped recording.');\n            if(currAudioBlob) {\n                $submitButton.show();\n            }\n            submitOrRerecord();\n        }\n    });\n\n    // ------------------------------------------------------------------------\n    function submitOrRerecord() {\n\n        recorder && recorder.exportWAV(function(blob) {\n\n            currAudioBlob = blob;\n            console.log(\"audio blob!\");\n\n            var sound_url = URL.createObjectURL(currAudioBlob);\n            var audio_elt = document.createElement('audio');\n            audio_elt.controls = true;\n            audio_elt.src = sound_url;\n            audio_elt.setAttribute('data-question', $(\".record\").attr('data-question'));\n\n\n            $('#recording-col').html( $(audio_elt) );\n            $recordButton.html(currAudioBlob ? \"Re-Record\" : \"Start Recording\");\n            if(currAudioBlob) {\n                $submitButton.show();\n            }\n            recorder.clear();\n        });\n  }\n\n});\n\n/*\n\n\n\n\n\n\n\n\n  function __log(e, data) {\n    console.log(e + \" \" + (data || ''));\n  }\n\n  var audio_context;\n  var recorder;\n  var recording=false;\n\n  function startUserMedia(stream) {\n    var input = audio_context.createMediaStreamSource(stream);\n    __log('Media stream created.');\n\n    // Uncomment if you want the audio to feedback directly\n    //input.connect(audio_context.destination);\n    //__log('Input connected to audio context destination.');\n    \n    recorder = new Recorder(input);\n    __log('Recorder initialised.');\n  }\n\nfunction toggleRecord(ev){\n    var btn = $(ev.target);\n    var spanverbiage = $(ev.target).parent().children('span').first();\n         if(btn.hasClass('notRec')){\n\n                 btn.removeClass(\"notRec\");\n                 btn.addClass(\"Rec\");\n                 // start recording now!\n                 spanverbiage.html(\"Stop\");\n                 recording = true;\n                 recorder && recorder.record();\n\n                 __log('Recording...');\n             } else {\n                 btn.removeClass(\"Rec\");\n                 btn.addClass(\"notRec\");\n\n                 spanverbiage.html(\"Re-Record\");\n\n                  // stop\n                 recording = false;\n                 recorder && recorder.stop();\n\n                 __log('Stopped recording.');\n                 // create WAV download link using audio data blob\n                 submitOrRerecord();\n\n             }\n\n     }\n     */\n\n/*\nvar Screensaver = require('./screensaver.js');\n\n$(function() {\n    /// dis nasty but trying to move fast here\n    var currAudioBlob;\n\n   //intro slide - only show 'let's go' when we're dang ready\n   var nameField = false\n   var emailField = false;\n   function testFields(keycode) { if (nameField && emailField) { \n    $(\".info button.hidden\").removeClass(\"hidden\");\n    if(keycode == 13) {\n        $.deck('next');\n    }\n    }}\n   $(\"#name-input\").keyup(function(){\n    nameField = true;\n    testFields(e.keyCode);\n   });\n   $(\"#email-input\").keyup(function(e){\n    emailField = true;\n    testFields(e.keyCode);\n   });\n   $(document).keyup(function(e) {\n     if(e.keyCode == 27) {\n        $(\"#terms\").addClass(\"hidden\");\n     }\n   })\n\n\n  \n\n    \n    $(document).bind('deck.change', function(event, from, to) {\n\t   console.log('Moving from slide ' + from + ' to ' + to);\n\n        // submit full data packets on the 'thanks' slide\n        if( $(\".deck-next\").hasClass('thanks')) {\n            // attempt to submit data\n            var question_attr = $(\".thanks.deck-next\").attr(\"data-question\");\n\n            var audio_blob = currAudioBlob;//$(\"audio[data-question='\"+question_attr+\"'\").attr('src');\n\n\n\n            var dataPacket = new FormData();\n\n            dataPacket.append('question', $(\".question[data-question='\"+question_attr+\"'] p.question-str\").html());\n            dataPacket.append('question_id', question_attr.substring(8,9));\n\n            var response = $(\"#\"+question_attr).val();\n            if (response == undefined) { response = '50'; }\n            dataPacket.append('response', response);\n\n\n            var question_care = $(\"#\"+question_attr+\"_care\").val();\n            if (question_care == undefined) { question_care = '50'; }            \n            dataPacket.append('strength', question_care);\n\n\n            dataPacket.append('csrf_token', $('meta[name=\"csrf_token\"]').attr('content'));\n            var name = ($(\"#name-input\").val().length == 0) ? \"No name given\" : $(\"#name-input\").val();\n            dataPacket.append('name', name);\n            var email = ($(\"#email-input\").val().length == 0) ? \"No@email.address\" : $(\"#email-input\").val();\n            dataPacket.append('email', email);\n            console.log(audio_blob);\n            dataPacket.append('audio_name', moment().format('x')+\"_audio.wav\");\n            dataPacket.append('audio_file', audio_blob);\n\n            // var dataPacket = {\n            //     'timestamp': moment().format('MM/DD/YYYY HH:mm:ss a'),\n            //     'question': $(\".question[data-question='\"+question_attr+\"'] p.question-str\").html(),\n            //     'question_id': question_attr.substring(8,9),\n            //     'response': $(\"#\"+question_attr).val(),\n            //     'strength': $(\"#\"+question_attr+\"_care\").val(),\n            //     'audio_file': audio_blob,\n            //     'name': $(\"#name-input\").val(),\n            //     'email': $(\"#email-input\").val()\n            // };\n\n            console.log(dataPacket);\n\n\n            $.ajax({\n                url: '/submit',\n                type: 'POST',\n                dataType: 'json',\n                data: dataPacket,\n                processData: false,\n                contentType: false\n               \n            })\n            .done(function(data, status, xhr) {\n                console.log(\"SUCCESS\");\n                console.log(\"data\", data);\n                console.log(\"status\", status);\n                console.log(\"xhr\", xhr);\n                console.log(\"-----------\");\n            })\n            .fail(function() {\n                console.log(\"error\");\n            })\n            .always(function(xhr, status) {\n                console.log(\"COMPLETE\");\n                console.log(\"status\", status);\n                console.log(\"xhr\", xhr);\n                console.log(\"-----------\");\n            });\n\n\n    \n        }\n\n\n        if( $(\".deck-next\").hasClass('autoplay')) {\n            setTimeout(function(){\n                if ( $(\".deck-current\").hasClass('autoplay') ){\n                    $.deck('next'); \n                }\n            }, 1200);\n        }\n\n        if( $(\".deck-next\").hasClass('done')) {\n            setTimeout(function(){\n                if ( $(\".deck-current\").hasClass('done') ){\n                    \n                    window.location.href = \"/\";\n                }\n            }, 5200);\n        }\n\n\t});\n\n\n\n    //todo - turn off arrow listeners on slideshow\n    //todo - hammerjs that ish\n\n\n    /////////////\n    // record stuff\n    /////////\n\n    try {\n      // webkit shim\n      window.AudioContext = window.AudioContext || window.webkitAudioContext;\n      navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia;\n      window.URL = window.URL || window.webkitURL;\n      \n      audio_context = new AudioContext;\n\n      __log('Audio context set up.');\n      __log('navigator.getUserMedia ' + (navigator.getUserMedia ? 'available.' : 'not present!'));\n    } catch (e) {\n        console.log(\"e: \", e)\n    }\n    \n    navigator.getUserMedia({audio: true}, startUserMedia, function(e) {\n      console.log('No live audio input: ', e);\n    });\n\n\n\n\n\n\n  function __log(e, data) {\n    console.log(e + \" \" + (data || ''));\n  }\n\n  var audio_context;\n  var recorder;\n  var recording=false;\n\n  function startUserMedia(stream) {\n    var input = audio_context.createMediaStreamSource(stream);\n    __log('Media stream created.');\n\n    // Uncomment if you want the audio to feedback directly\n    //input.connect(audio_context.destination);\n    //__log('Input connected to audio context destination.');\n    \n    recorder = new Recorder(input);\n    __log('Recorder initialised.');\n  }\n\nfunction toggleRecord(ev){\n    var btn = $(ev.target);\n    var spanverbiage = $(ev.target).parent().children('span').first();\n         if(btn.hasClass('notRec')){\n\n                 btn.removeClass(\"notRec\");\n                 btn.addClass(\"Rec\");\n                 // start recording now!\n                 spanverbiage.html(\"Stop\");\n                 recording = true;\n                 recorder && recorder.record();\n\n                 __log('Recording...');\n             } else {\n                 btn.removeClass(\"Rec\");\n                 btn.addClass(\"notRec\");\n\n                 spanverbiage.html(\"Re-Record\");\n\n                  // stop\n                 recording = false;\n                 recorder && recorder.stop();\n\n                 __log('Stopped recording.');\n                 // create WAV download link using audio data blob\n                 submitOrRerecord();\n\n             }\n\n     }\n\n  //  var recordButton = $('.recorder-button button');\n   //   // record button clickers\n     // recordButton.each(function(){\n     //     var $this = $(this);\n     //     var $spanVerbiage = $(this).parent().find('span').first();\n     //     var mc = new Hammer(this);\n     //     mc.on(\"tap\", function() {\n     //         if($this.hasClass('notRec')){\n\n     //             $this.removeClass(\"notRec\");\n     //             $this.addClass(\"Rec\");\n     //             // start recording now!\n     //             $spanVerbiage.html(\"Stop\");\n     //             recording = true;\n     //             recorder && recorder.record();\n\n     //             __log('Recording...');\n     //         } else {\n     //             $this.removeClass(\"Rec\");\n     //             $this.addClass(\"notRec\");\n\n     //             $spanVerbiage.html(\"Re-Record\");\n\n     //              // stop\n     //             recording = false;\n     //             recorder && recorder.stop();\n\n     //             __log('Stopped recording.');\n     //             // create WAV download link using audio data blob\n     //             submitOrRerecord();\n\n     //         }\n     //     });\n     // });\n\n\n\n  function submitOrRerecord() {\n    console.log(\"hey man!\");\n    console.log(recorder);\n\n    recorder && recorder.exportWAV(function(blob) {\n      currAudioBlob = blob;\n      console.log(\"audio blob!\");\n\n      var thisQuestion = $(\".record.deck-current\").attr('data-question');\n\n      var sound_url = URL.createObjectURL(currAudioBlob);\n      var audio_elt = document.createElement('audio');\n      audio_elt.controls = true;\n      audio_elt.src = sound_url;\n      audio_elt.setAttribute('data-question', $(\".record\").attr('data-question'));\n\n      console.log(thisQuestion);\n      var currQuestionsPlayer = $(\".record[data-question='\"+thisQuestion+\"'] .playMostRecent\");\n      currQuestionsPlayer.html(\"\");\n      currQuestionsPlayer.append( $(audio_elt) );\n     // currQuestionsPlayer.append($(audio_link));\n\n      currQuestionsPlayer.find(\"audio\").attr(\"data-question\", thisQuestion);\n\n\n      $(\".deck-current.record button.next\").removeClass(\"hidden\");\n\n        recorder.clear();\n\n    });\n  }\n\n\n\n\n});*///# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2FwcC5qcz84YjY3Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oJCkge1xuICAgIFxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgdmFyICRtZW51ID0gJCgnLnVzZXItZHJvcGRvd24tbWVudScpO1xuICAgICQoXCIudXNlci1pbWFnZVwiKS5jbGljayhmdW5jdGlvbihldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAkbWVudS50b2dnbGVDbGFzcygnb3BlbicpO1xuICAgIH0pO1xuXG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBmdW5jdGlvbiBfX2xvZyhlLCBkYXRhKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGUgKyBcIiBcIiArIChkYXRhIHx8ICcnKSk7XG4gICAgfVxuXG4gICAgdmFyIGF1ZGlvX2NvbnRleHQ7XG4gICAgdmFyIHJlY29yZGVyO1xuICAgIHZhciByZWNvcmRpbmcgPSBmYWxzZTtcbiAgICB2YXIgJGZvcm0gPSAkKCdmb3JtJyk7XG4gICAgdmFyIGN1cnJBdWRpb0Jsb2IgPSBudWxsO1xuICAgIHZhciAkZm9ybSA9ICQoXCJmb3JtXCIpO1xuICAgIHZhciAkc3VibWl0QnV0dG9uID0gJChcIiNzdWJtaXRcIik7XG4gICAgdmFyIHRva2VuID0gJCgnbWV0YVtuYW1lPVwiY3NyZl90b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKVxuICAgICRzdWJtaXRCdXR0b24uaGlkZSgpO1xuXG4gICAgJCgnI2ZpbGUtdXBsb2FkJykuY2hhbmdlKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICRzdWJtaXRCdXR0b24uc2hvdygpO1xuICAgIH0pO1xuICAgICQoJy5kZWxldGUtcmVjb3JkaW5nJykuY2xpY2soZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdmFyIGlkID0gJCh0aGlzKS5kYXRhKCdpZCcpO1xuICAgICAgICB2YXIgZGF0YSA9IHtfbWV0aG9kOiAnREVMRVRFJywgJ190b2tlbic6IHRva2VufTtcbiAgICAgICAgdmFyICRlbCA9ICQoJy5yZWNvcmRpbmctJytpZCk7XG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcvcmVjb3JkaW5ncy8nK2lkLFxuICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgIH0pXG4gICAgICAgIC5kb25lKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGlmKGUuc3RhdHVzID4gMjAwKSB7XG4gICAgICAgICAgICAgICAgJGVsLmZhZGVUbygyMDAsIDAsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZSgpOyAgIFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3JcIik7XG4gICAgICAgIH0pXG4gICAgICAgIC5hbHdheXMoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNvbXBsZXRlXCIpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgfSk7XG4gICAgJGZvcm0uc3VibWl0KGZ1bmN0aW9uKCBldmVudCApIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJQb3N0IFJlY29yZGluZ1wiKTtcbiAgICAgICAgaWYoIWN1cnJBdWRpb0Jsb2IgJiYgJCgnI2ZpbGUtdXBsb2FkJykudmFsKCkgPT0gXCJcIikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJNaXNzaW5nIHJlY29yZGluZ1wiKTtcbiAgICAgICAgICAgIHJldHVybjsgICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0YSA9IG5ldyBGb3JtRGF0YSgkKCdmb3JtJylbMF0pO1xuICAgICAgICBpZihjdXJyQXVkaW9CbG9iKSB7XG4gICAgICAgICAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtjdXJyQXVkaW9CbG9iXSwge3R5cGU6IFwiYXVkaW8vd2F2XCJ9KTtcbiAgICAgICAgICAgIGRhdGEuYXBwZW5kKCdhdWRpb19uYW1lJywgbW9tZW50KCkuZm9ybWF0KCd4JykrXCJfYXVkaW8ud2F2XCIpO1xuICAgICAgICAgICAgZGF0YS5hcHBlbmQoJ2F1ZGlvX2ZpbGUnLCBibG9iKTtcbiAgICAgICAgfVxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiAnL3N1Ym1pdCcsXG4gICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgIHByb2Nlc3NEYXRhOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBmYWxzZVxuICAgICAgICB9KVxuICAgICAgICAuZG9uZShmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInN1Y2Nlc3NcIiwgZSk7XG4gICAgICAgICAgICBpZihlLnN0YXR1cyA+IDIwMCkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmxvY2F0aW9uID0gJy8nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuZmFpbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3JcIik7XG4gICAgICAgIH0pXG4gICAgICAgIC5hbHdheXMoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNvbXBsZXRlXCIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGZ1bmN0aW9uIHN0YXJ0VXNlck1lZGlhKHN0cmVhbSkge1xuICAgICAgICB2YXIgaW5wdXQgPSBhdWRpb19jb250ZXh0LmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHN0cmVhbSk7XG4gICAgICAgICBfX2xvZygnTWVkaWEgc3RyZWFtIGNyZWF0ZWQuJyk7XG5cbiAgICAgICAgLy8gVW5jb21tZW50IGlmIHlvdSB3YW50IHRoZSBhdWRpbyB0byBmZWVkYmFjayBkaXJlY3RseVxuICAgICAgICAvL2lucHV0LmNvbm5lY3QoYXVkaW9fY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgIC8vX19sb2coJ0lucHV0IGNvbm5lY3RlZCB0byBhdWRpbyBjb250ZXh0IGRlc3RpbmF0aW9uLicpO1xuICAgIFxuICAgICAgICByZWNvcmRlciA9IG5ldyBSZWNvcmRlcihpbnB1dCk7XG4gICAgICAgIF9fbG9nKCdSZWNvcmRlciBpbml0aWFsaXNlZC4nKTtcbiAgICB9XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICB0cnkge1xuICAgICAgICBcbiAgICAgICAgLy8gd2Via2l0IHNoaW1cbiAgICAgICAgd2luZG93LkF1ZGlvQ29udGV4dCA9IHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dDtcbiAgICAgICAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5nZXRVc2VyTWVkaWEgfHwgbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYTtcbiAgICAgICAgd2luZG93LlVSTCA9IHdpbmRvdy5VUkwgfHwgd2luZG93LndlYmtpdFVSTDtcbiAgICAgIFxuICAgICAgICBhdWRpb19jb250ZXh0ID0gbmV3IEF1ZGlvQ29udGV4dDtcblxuICAgICAgICBfX2xvZygnQXVkaW8gY29udGV4dCBzZXQgdXAuJyk7XG4gICAgICAgIF9fbG9nKCduYXZpZ2F0b3IuZ2V0VXNlck1lZGlhICcgKyAobmF2aWdhdG9yLmdldFVzZXJNZWRpYSA/ICdhdmFpbGFibGUuJyA6ICdub3QgcHJlc2VudCEnKSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImU6IFwiLCBlKVxuICAgIH1cbiAgICBcbiAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhKHthdWRpbzogdHJ1ZX0sIHN0YXJ0VXNlck1lZGlhLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdObyBsaXZlIGF1ZGlvIGlucHV0OiAnLCBlKTtcbiAgICB9KTtcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHZhciBpc1JlY29yZGluZyA9IGZhbHNlO1xuICAgIHZhciAkcmVjb3JkQnV0dG9uID0gJCgnI3JlY29yZGluZycpO1xuICAgICRyZWNvcmRCdXR0b24uY2xpY2soZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc29sZS5sb2coY3VyckF1ZGlvQmxvYik7XG4gICAgICAgIC8vIHN0YXJ0IHJlY29yZGluZ1xuICAgICAgICBpZighaXNSZWNvcmRpbmcpIHtcbiAgICAgICAgICAgIGlzUmVjb3JkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHJlY29yZGVyICYmIHJlY29yZGVyLnJlY29yZCgpO1xuICAgICAgICAgICAgX19sb2coJ1JlY29yZGluZy4uLicpO1xuICAgICAgICAgICAgJCh0aGlzKS5odG1sKFwiU3RvcCBSZWNvcmRpbmdcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzdG9wIHJlY29yZGluZ1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlzUmVjb3JkaW5nID0gZmFsc2U7ICAgXG4gICAgICAgICAgICAkKHRoaXMpLmh0bWwoY3VyckF1ZGlvQmxvYiA/IFwiUmUtUmVjb3JkXCIgOiBcIlN0YXJ0IFJlY29yZGluZ1wiKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gc3RvcFxuICAgICAgICAgICAgcmVjb3JkZXIgJiYgcmVjb3JkZXIuc3RvcCgpO1xuICAgICAgICAgICAgX19sb2coJ1N0b3BwZWQgcmVjb3JkaW5nLicpO1xuICAgICAgICAgICAgaWYoY3VyckF1ZGlvQmxvYikge1xuICAgICAgICAgICAgICAgICRzdWJtaXRCdXR0b24uc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3VibWl0T3JSZXJlY29yZCgpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBmdW5jdGlvbiBzdWJtaXRPclJlcmVjb3JkKCkge1xuXG4gICAgICAgIHJlY29yZGVyICYmIHJlY29yZGVyLmV4cG9ydFdBVihmdW5jdGlvbihibG9iKSB7XG5cbiAgICAgICAgICAgIGN1cnJBdWRpb0Jsb2IgPSBibG9iO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJhdWRpbyBibG9iIVwiKTtcblxuICAgICAgICAgICAgdmFyIHNvdW5kX3VybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoY3VyckF1ZGlvQmxvYik7XG4gICAgICAgICAgICB2YXIgYXVkaW9fZWx0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXVkaW8nKTtcbiAgICAgICAgICAgIGF1ZGlvX2VsdC5jb250cm9scyA9IHRydWU7XG4gICAgICAgICAgICBhdWRpb19lbHQuc3JjID0gc291bmRfdXJsO1xuICAgICAgICAgICAgYXVkaW9fZWx0LnNldEF0dHJpYnV0ZSgnZGF0YS1xdWVzdGlvbicsICQoXCIucmVjb3JkXCIpLmF0dHIoJ2RhdGEtcXVlc3Rpb24nKSk7XG5cblxuICAgICAgICAgICAgJCgnI3JlY29yZGluZy1jb2wnKS5odG1sKCAkKGF1ZGlvX2VsdCkgKTtcbiAgICAgICAgICAgICRyZWNvcmRCdXR0b24uaHRtbChjdXJyQXVkaW9CbG9iID8gXCJSZS1SZWNvcmRcIiA6IFwiU3RhcnQgUmVjb3JkaW5nXCIpO1xuICAgICAgICAgICAgaWYoY3VyckF1ZGlvQmxvYikge1xuICAgICAgICAgICAgICAgICRzdWJtaXRCdXR0b24uc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVjb3JkZXIuY2xlYXIoKTtcbiAgICAgICAgfSk7XG4gIH1cblxufSk7XG5cbi8qXG5cblxuXG5cblxuXG5cblxuICBmdW5jdGlvbiBfX2xvZyhlLCBkYXRhKSB7XG4gICAgY29uc29sZS5sb2coZSArIFwiIFwiICsgKGRhdGEgfHwgJycpKTtcbiAgfVxuXG4gIHZhciBhdWRpb19jb250ZXh0O1xuICB2YXIgcmVjb3JkZXI7XG4gIHZhciByZWNvcmRpbmc9ZmFsc2U7XG5cbiAgZnVuY3Rpb24gc3RhcnRVc2VyTWVkaWEoc3RyZWFtKSB7XG4gICAgdmFyIGlucHV0ID0gYXVkaW9fY29udGV4dC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZShzdHJlYW0pO1xuICAgIF9fbG9nKCdNZWRpYSBzdHJlYW0gY3JlYXRlZC4nKTtcblxuICAgIC8vIFVuY29tbWVudCBpZiB5b3Ugd2FudCB0aGUgYXVkaW8gdG8gZmVlZGJhY2sgZGlyZWN0bHlcbiAgICAvL2lucHV0LmNvbm5lY3QoYXVkaW9fY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgLy9fX2xvZygnSW5wdXQgY29ubmVjdGVkIHRvIGF1ZGlvIGNvbnRleHQgZGVzdGluYXRpb24uJyk7XG4gICAgXG4gICAgcmVjb3JkZXIgPSBuZXcgUmVjb3JkZXIoaW5wdXQpO1xuICAgIF9fbG9nKCdSZWNvcmRlciBpbml0aWFsaXNlZC4nKTtcbiAgfVxuXG5mdW5jdGlvbiB0b2dnbGVSZWNvcmQoZXYpe1xuICAgIHZhciBidG4gPSAkKGV2LnRhcmdldCk7XG4gICAgdmFyIHNwYW52ZXJiaWFnZSA9ICQoZXYudGFyZ2V0KS5wYXJlbnQoKS5jaGlsZHJlbignc3BhbicpLmZpcnN0KCk7XG4gICAgICAgICBpZihidG4uaGFzQ2xhc3MoJ25vdFJlYycpKXtcblxuICAgICAgICAgICAgICAgICBidG4ucmVtb3ZlQ2xhc3MoXCJub3RSZWNcIik7XG4gICAgICAgICAgICAgICAgIGJ0bi5hZGRDbGFzcyhcIlJlY1wiKTtcbiAgICAgICAgICAgICAgICAgLy8gc3RhcnQgcmVjb3JkaW5nIG5vdyFcbiAgICAgICAgICAgICAgICAgc3BhbnZlcmJpYWdlLmh0bWwoXCJTdG9wXCIpO1xuICAgICAgICAgICAgICAgICByZWNvcmRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICByZWNvcmRlciAmJiByZWNvcmRlci5yZWNvcmQoKTtcblxuICAgICAgICAgICAgICAgICBfX2xvZygnUmVjb3JkaW5nLi4uJyk7XG4gICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgYnRuLnJlbW92ZUNsYXNzKFwiUmVjXCIpO1xuICAgICAgICAgICAgICAgICBidG4uYWRkQ2xhc3MoXCJub3RSZWNcIik7XG5cbiAgICAgICAgICAgICAgICAgc3BhbnZlcmJpYWdlLmh0bWwoXCJSZS1SZWNvcmRcIik7XG5cbiAgICAgICAgICAgICAgICAgIC8vIHN0b3BcbiAgICAgICAgICAgICAgICAgcmVjb3JkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgIHJlY29yZGVyICYmIHJlY29yZGVyLnN0b3AoKTtcblxuICAgICAgICAgICAgICAgICBfX2xvZygnU3RvcHBlZCByZWNvcmRpbmcuJyk7XG4gICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBXQVYgZG93bmxvYWQgbGluayB1c2luZyBhdWRpbyBkYXRhIGJsb2JcbiAgICAgICAgICAgICAgICAgc3VibWl0T3JSZXJlY29yZCgpO1xuXG4gICAgICAgICAgICAgfVxuXG4gICAgIH1cbiAgICAgKi9cblxuLypcbnZhciBTY3JlZW5zYXZlciA9IHJlcXVpcmUoJy4vc2NyZWVuc2F2ZXIuanMnKTtcblxuJChmdW5jdGlvbigpIHtcbiAgICAvLy8gZGlzIG5hc3R5IGJ1dCB0cnlpbmcgdG8gbW92ZSBmYXN0IGhlcmVcbiAgICB2YXIgY3VyckF1ZGlvQmxvYjtcblxuICAgLy9pbnRybyBzbGlkZSAtIG9ubHkgc2hvdyAnbGV0J3MgZ28nIHdoZW4gd2UncmUgZGFuZyByZWFkeVxuICAgdmFyIG5hbWVGaWVsZCA9IGZhbHNlXG4gICB2YXIgZW1haWxGaWVsZCA9IGZhbHNlO1xuICAgZnVuY3Rpb24gdGVzdEZpZWxkcyhrZXljb2RlKSB7IGlmIChuYW1lRmllbGQgJiYgZW1haWxGaWVsZCkgeyBcbiAgICAkKFwiLmluZm8gYnV0dG9uLmhpZGRlblwiKS5yZW1vdmVDbGFzcyhcImhpZGRlblwiKTtcbiAgICBpZihrZXljb2RlID09IDEzKSB7XG4gICAgICAgICQuZGVjaygnbmV4dCcpO1xuICAgIH1cbiAgICB9fVxuICAgJChcIiNuYW1lLWlucHV0XCIpLmtleXVwKGZ1bmN0aW9uKCl7XG4gICAgbmFtZUZpZWxkID0gdHJ1ZTtcbiAgICB0ZXN0RmllbGRzKGUua2V5Q29kZSk7XG4gICB9KTtcbiAgICQoXCIjZW1haWwtaW5wdXRcIikua2V5dXAoZnVuY3Rpb24oZSl7XG4gICAgZW1haWxGaWVsZCA9IHRydWU7XG4gICAgdGVzdEZpZWxkcyhlLmtleUNvZGUpO1xuICAgfSk7XG4gICAkKGRvY3VtZW50KS5rZXl1cChmdW5jdGlvbihlKSB7XG4gICAgIGlmKGUua2V5Q29kZSA9PSAyNykge1xuICAgICAgICAkKFwiI3Rlcm1zXCIpLmFkZENsYXNzKFwiaGlkZGVuXCIpO1xuICAgICB9XG4gICB9KVxuXG5cbiAgXG5cbiAgICBcbiAgICAkKGRvY3VtZW50KS5iaW5kKCdkZWNrLmNoYW5nZScsIGZ1bmN0aW9uKGV2ZW50LCBmcm9tLCB0bykge1xuXHQgICBjb25zb2xlLmxvZygnTW92aW5nIGZyb20gc2xpZGUgJyArIGZyb20gKyAnIHRvICcgKyB0byk7XG5cbiAgICAgICAgLy8gc3VibWl0IGZ1bGwgZGF0YSBwYWNrZXRzIG9uIHRoZSAndGhhbmtzJyBzbGlkZVxuICAgICAgICBpZiggJChcIi5kZWNrLW5leHRcIikuaGFzQ2xhc3MoJ3RoYW5rcycpKSB7XG4gICAgICAgICAgICAvLyBhdHRlbXB0IHRvIHN1Ym1pdCBkYXRhXG4gICAgICAgICAgICB2YXIgcXVlc3Rpb25fYXR0ciA9ICQoXCIudGhhbmtzLmRlY2stbmV4dFwiKS5hdHRyKFwiZGF0YS1xdWVzdGlvblwiKTtcblxuICAgICAgICAgICAgdmFyIGF1ZGlvX2Jsb2IgPSBjdXJyQXVkaW9CbG9iOy8vJChcImF1ZGlvW2RhdGEtcXVlc3Rpb249J1wiK3F1ZXN0aW9uX2F0dHIrXCInXCIpLmF0dHIoJ3NyYycpO1xuXG5cblxuICAgICAgICAgICAgdmFyIGRhdGFQYWNrZXQgPSBuZXcgRm9ybURhdGEoKTtcblxuICAgICAgICAgICAgZGF0YVBhY2tldC5hcHBlbmQoJ3F1ZXN0aW9uJywgJChcIi5xdWVzdGlvbltkYXRhLXF1ZXN0aW9uPSdcIitxdWVzdGlvbl9hdHRyK1wiJ10gcC5xdWVzdGlvbi1zdHJcIikuaHRtbCgpKTtcbiAgICAgICAgICAgIGRhdGFQYWNrZXQuYXBwZW5kKCdxdWVzdGlvbl9pZCcsIHF1ZXN0aW9uX2F0dHIuc3Vic3RyaW5nKDgsOSkpO1xuXG4gICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSAkKFwiI1wiK3F1ZXN0aW9uX2F0dHIpLnZhbCgpO1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlID09IHVuZGVmaW5lZCkgeyByZXNwb25zZSA9ICc1MCc7IH1cbiAgICAgICAgICAgIGRhdGFQYWNrZXQuYXBwZW5kKCdyZXNwb25zZScsIHJlc3BvbnNlKTtcblxuXG4gICAgICAgICAgICB2YXIgcXVlc3Rpb25fY2FyZSA9ICQoXCIjXCIrcXVlc3Rpb25fYXR0citcIl9jYXJlXCIpLnZhbCgpO1xuICAgICAgICAgICAgaWYgKHF1ZXN0aW9uX2NhcmUgPT0gdW5kZWZpbmVkKSB7IHF1ZXN0aW9uX2NhcmUgPSAnNTAnOyB9ICAgICAgICAgICAgXG4gICAgICAgICAgICBkYXRhUGFja2V0LmFwcGVuZCgnc3RyZW5ndGgnLCBxdWVzdGlvbl9jYXJlKTtcblxuXG4gICAgICAgICAgICBkYXRhUGFja2V0LmFwcGVuZCgnY3NyZl90b2tlbicsICQoJ21ldGFbbmFtZT1cImNzcmZfdG9rZW5cIl0nKS5hdHRyKCdjb250ZW50JykpO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSAoJChcIiNuYW1lLWlucHV0XCIpLnZhbCgpLmxlbmd0aCA9PSAwKSA/IFwiTm8gbmFtZSBnaXZlblwiIDogJChcIiNuYW1lLWlucHV0XCIpLnZhbCgpO1xuICAgICAgICAgICAgZGF0YVBhY2tldC5hcHBlbmQoJ25hbWUnLCBuYW1lKTtcbiAgICAgICAgICAgIHZhciBlbWFpbCA9ICgkKFwiI2VtYWlsLWlucHV0XCIpLnZhbCgpLmxlbmd0aCA9PSAwKSA/IFwiTm9AZW1haWwuYWRkcmVzc1wiIDogJChcIiNlbWFpbC1pbnB1dFwiKS52YWwoKTtcbiAgICAgICAgICAgIGRhdGFQYWNrZXQuYXBwZW5kKCdlbWFpbCcsIGVtYWlsKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGF1ZGlvX2Jsb2IpO1xuICAgICAgICAgICAgZGF0YVBhY2tldC5hcHBlbmQoJ2F1ZGlvX25hbWUnLCBtb21lbnQoKS5mb3JtYXQoJ3gnKStcIl9hdWRpby53YXZcIik7XG4gICAgICAgICAgICBkYXRhUGFja2V0LmFwcGVuZCgnYXVkaW9fZmlsZScsIGF1ZGlvX2Jsb2IpO1xuXG4gICAgICAgICAgICAvLyB2YXIgZGF0YVBhY2tldCA9IHtcbiAgICAgICAgICAgIC8vICAgICAndGltZXN0YW1wJzogbW9tZW50KCkuZm9ybWF0KCdNTS9ERC9ZWVlZIEhIOm1tOnNzIGEnKSxcbiAgICAgICAgICAgIC8vICAgICAncXVlc3Rpb24nOiAkKFwiLnF1ZXN0aW9uW2RhdGEtcXVlc3Rpb249J1wiK3F1ZXN0aW9uX2F0dHIrXCInXSBwLnF1ZXN0aW9uLXN0clwiKS5odG1sKCksXG4gICAgICAgICAgICAvLyAgICAgJ3F1ZXN0aW9uX2lkJzogcXVlc3Rpb25fYXR0ci5zdWJzdHJpbmcoOCw5KSxcbiAgICAgICAgICAgIC8vICAgICAncmVzcG9uc2UnOiAkKFwiI1wiK3F1ZXN0aW9uX2F0dHIpLnZhbCgpLFxuICAgICAgICAgICAgLy8gICAgICdzdHJlbmd0aCc6ICQoXCIjXCIrcXVlc3Rpb25fYXR0citcIl9jYXJlXCIpLnZhbCgpLFxuICAgICAgICAgICAgLy8gICAgICdhdWRpb19maWxlJzogYXVkaW9fYmxvYixcbiAgICAgICAgICAgIC8vICAgICAnbmFtZSc6ICQoXCIjbmFtZS1pbnB1dFwiKS52YWwoKSxcbiAgICAgICAgICAgIC8vICAgICAnZW1haWwnOiAkKFwiI2VtYWlsLWlucHV0XCIpLnZhbCgpXG4gICAgICAgICAgICAvLyB9O1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhUGFja2V0KTtcblxuXG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIHVybDogJy9zdWJtaXQnLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGFQYWNrZXQsXG4gICAgICAgICAgICAgICAgcHJvY2Vzc0RhdGE6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBmYWxzZVxuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCB4aHIpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNVQ0NFU1NcIik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJkYXRhXCIsIGRhdGEpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic3RhdHVzXCIsIHN0YXR1cyk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ4aHJcIiwgeGhyKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tXCIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3JcIik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmFsd2F5cyhmdW5jdGlvbih4aHIsIHN0YXR1cykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ09NUExFVEVcIik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzdGF0dXNcIiwgc3RhdHVzKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInhoclwiLCB4aHIpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiLS0tLS0tLS0tLS1cIik7XG4gICAgICAgICAgICB9KTtcblxuXG4gICAgXG4gICAgICAgIH1cblxuXG4gICAgICAgIGlmKCAkKFwiLmRlY2stbmV4dFwiKS5oYXNDbGFzcygnYXV0b3BsYXknKSkge1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGlmICggJChcIi5kZWNrLWN1cnJlbnRcIikuaGFzQ2xhc3MoJ2F1dG9wbGF5JykgKXtcbiAgICAgICAgICAgICAgICAgICAgJC5kZWNrKCduZXh0Jyk7IFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDEyMDApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYoICQoXCIuZGVjay1uZXh0XCIpLmhhc0NsYXNzKCdkb25lJykpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZiAoICQoXCIuZGVjay1jdXJyZW50XCIpLmhhc0NsYXNzKCdkb25lJykgKXtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIvXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgNTIwMCk7XG4gICAgICAgIH1cblxuXHR9KTtcblxuXG5cbiAgICAvL3RvZG8gLSB0dXJuIG9mZiBhcnJvdyBsaXN0ZW5lcnMgb24gc2xpZGVzaG93XG4gICAgLy90b2RvIC0gaGFtbWVyanMgdGhhdCBpc2hcblxuXG4gICAgLy8vLy8vLy8vLy8vL1xuICAgIC8vIHJlY29yZCBzdHVmZlxuICAgIC8vLy8vLy8vL1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIHdlYmtpdCBzaGltXG4gICAgICB3aW5kb3cuQXVkaW9Db250ZXh0ID0gd2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0O1xuICAgICAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5nZXRVc2VyTWVkaWEgfHwgbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYTtcbiAgICAgIHdpbmRvdy5VUkwgPSB3aW5kb3cuVVJMIHx8IHdpbmRvdy53ZWJraXRVUkw7XG4gICAgICBcbiAgICAgIGF1ZGlvX2NvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0O1xuXG4gICAgICBfX2xvZygnQXVkaW8gY29udGV4dCBzZXQgdXAuJyk7XG4gICAgICBfX2xvZygnbmF2aWdhdG9yLmdldFVzZXJNZWRpYSAnICsgKG5hdmlnYXRvci5nZXRVc2VyTWVkaWEgPyAnYXZhaWxhYmxlLicgOiAnbm90IHByZXNlbnQhJykpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJlOiBcIiwgZSlcbiAgICB9XG4gICAgXG4gICAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSh7YXVkaW86IHRydWV9LCBzdGFydFVzZXJNZWRpYSwgZnVuY3Rpb24oZSkge1xuICAgICAgY29uc29sZS5sb2coJ05vIGxpdmUgYXVkaW8gaW5wdXQ6ICcsIGUpO1xuICAgIH0pO1xuXG5cblxuXG5cblxuICBmdW5jdGlvbiBfX2xvZyhlLCBkYXRhKSB7XG4gICAgY29uc29sZS5sb2coZSArIFwiIFwiICsgKGRhdGEgfHwgJycpKTtcbiAgfVxuXG4gIHZhciBhdWRpb19jb250ZXh0O1xuICB2YXIgcmVjb3JkZXI7XG4gIHZhciByZWNvcmRpbmc9ZmFsc2U7XG5cbiAgZnVuY3Rpb24gc3RhcnRVc2VyTWVkaWEoc3RyZWFtKSB7XG4gICAgdmFyIGlucHV0ID0gYXVkaW9fY29udGV4dC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZShzdHJlYW0pO1xuICAgIF9fbG9nKCdNZWRpYSBzdHJlYW0gY3JlYXRlZC4nKTtcblxuICAgIC8vIFVuY29tbWVudCBpZiB5b3Ugd2FudCB0aGUgYXVkaW8gdG8gZmVlZGJhY2sgZGlyZWN0bHlcbiAgICAvL2lucHV0LmNvbm5lY3QoYXVkaW9fY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgLy9fX2xvZygnSW5wdXQgY29ubmVjdGVkIHRvIGF1ZGlvIGNvbnRleHQgZGVzdGluYXRpb24uJyk7XG4gICAgXG4gICAgcmVjb3JkZXIgPSBuZXcgUmVjb3JkZXIoaW5wdXQpO1xuICAgIF9fbG9nKCdSZWNvcmRlciBpbml0aWFsaXNlZC4nKTtcbiAgfVxuXG5mdW5jdGlvbiB0b2dnbGVSZWNvcmQoZXYpe1xuICAgIHZhciBidG4gPSAkKGV2LnRhcmdldCk7XG4gICAgdmFyIHNwYW52ZXJiaWFnZSA9ICQoZXYudGFyZ2V0KS5wYXJlbnQoKS5jaGlsZHJlbignc3BhbicpLmZpcnN0KCk7XG4gICAgICAgICBpZihidG4uaGFzQ2xhc3MoJ25vdFJlYycpKXtcblxuICAgICAgICAgICAgICAgICBidG4ucmVtb3ZlQ2xhc3MoXCJub3RSZWNcIik7XG4gICAgICAgICAgICAgICAgIGJ0bi5hZGRDbGFzcyhcIlJlY1wiKTtcbiAgICAgICAgICAgICAgICAgLy8gc3RhcnQgcmVjb3JkaW5nIG5vdyFcbiAgICAgICAgICAgICAgICAgc3BhbnZlcmJpYWdlLmh0bWwoXCJTdG9wXCIpO1xuICAgICAgICAgICAgICAgICByZWNvcmRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICByZWNvcmRlciAmJiByZWNvcmRlci5yZWNvcmQoKTtcblxuICAgICAgICAgICAgICAgICBfX2xvZygnUmVjb3JkaW5nLi4uJyk7XG4gICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgYnRuLnJlbW92ZUNsYXNzKFwiUmVjXCIpO1xuICAgICAgICAgICAgICAgICBidG4uYWRkQ2xhc3MoXCJub3RSZWNcIik7XG5cbiAgICAgICAgICAgICAgICAgc3BhbnZlcmJpYWdlLmh0bWwoXCJSZS1SZWNvcmRcIik7XG5cbiAgICAgICAgICAgICAgICAgIC8vIHN0b3BcbiAgICAgICAgICAgICAgICAgcmVjb3JkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgIHJlY29yZGVyICYmIHJlY29yZGVyLnN0b3AoKTtcblxuICAgICAgICAgICAgICAgICBfX2xvZygnU3RvcHBlZCByZWNvcmRpbmcuJyk7XG4gICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBXQVYgZG93bmxvYWQgbGluayB1c2luZyBhdWRpbyBkYXRhIGJsb2JcbiAgICAgICAgICAgICAgICAgc3VibWl0T3JSZXJlY29yZCgpO1xuXG4gICAgICAgICAgICAgfVxuXG4gICAgIH1cblxuICAvLyAgdmFyIHJlY29yZEJ1dHRvbiA9ICQoJy5yZWNvcmRlci1idXR0b24gYnV0dG9uJyk7XG4gICAvLyAgIC8vIHJlY29yZCBidXR0b24gY2xpY2tlcnNcbiAgICAgLy8gcmVjb3JkQnV0dG9uLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgLy8gICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG4gICAgIC8vICAgICB2YXIgJHNwYW5WZXJiaWFnZSA9ICQodGhpcykucGFyZW50KCkuZmluZCgnc3BhbicpLmZpcnN0KCk7XG4gICAgIC8vICAgICB2YXIgbWMgPSBuZXcgSGFtbWVyKHRoaXMpO1xuICAgICAvLyAgICAgbWMub24oXCJ0YXBcIiwgZnVuY3Rpb24oKSB7XG4gICAgIC8vICAgICAgICAgaWYoJHRoaXMuaGFzQ2xhc3MoJ25vdFJlYycpKXtcblxuICAgICAvLyAgICAgICAgICAgICAkdGhpcy5yZW1vdmVDbGFzcyhcIm5vdFJlY1wiKTtcbiAgICAgLy8gICAgICAgICAgICAgJHRoaXMuYWRkQ2xhc3MoXCJSZWNcIik7XG4gICAgIC8vICAgICAgICAgICAgIC8vIHN0YXJ0IHJlY29yZGluZyBub3chXG4gICAgIC8vICAgICAgICAgICAgICRzcGFuVmVyYmlhZ2UuaHRtbChcIlN0b3BcIik7XG4gICAgIC8vICAgICAgICAgICAgIHJlY29yZGluZyA9IHRydWU7XG4gICAgIC8vICAgICAgICAgICAgIHJlY29yZGVyICYmIHJlY29yZGVyLnJlY29yZCgpO1xuXG4gICAgIC8vICAgICAgICAgICAgIF9fbG9nKCdSZWNvcmRpbmcuLi4nKTtcbiAgICAgLy8gICAgICAgICB9IGVsc2Uge1xuICAgICAvLyAgICAgICAgICAgICAkdGhpcy5yZW1vdmVDbGFzcyhcIlJlY1wiKTtcbiAgICAgLy8gICAgICAgICAgICAgJHRoaXMuYWRkQ2xhc3MoXCJub3RSZWNcIik7XG5cbiAgICAgLy8gICAgICAgICAgICAgJHNwYW5WZXJiaWFnZS5odG1sKFwiUmUtUmVjb3JkXCIpO1xuXG4gICAgIC8vICAgICAgICAgICAgICAvLyBzdG9wXG4gICAgIC8vICAgICAgICAgICAgIHJlY29yZGluZyA9IGZhbHNlO1xuICAgICAvLyAgICAgICAgICAgICByZWNvcmRlciAmJiByZWNvcmRlci5zdG9wKCk7XG5cbiAgICAgLy8gICAgICAgICAgICAgX19sb2coJ1N0b3BwZWQgcmVjb3JkaW5nLicpO1xuICAgICAvLyAgICAgICAgICAgICAvLyBjcmVhdGUgV0FWIGRvd25sb2FkIGxpbmsgdXNpbmcgYXVkaW8gZGF0YSBibG9iXG4gICAgIC8vICAgICAgICAgICAgIHN1Ym1pdE9yUmVyZWNvcmQoKTtcblxuICAgICAvLyAgICAgICAgIH1cbiAgICAgLy8gICAgIH0pO1xuICAgICAvLyB9KTtcblxuXG5cbiAgZnVuY3Rpb24gc3VibWl0T3JSZXJlY29yZCgpIHtcbiAgICBjb25zb2xlLmxvZyhcImhleSBtYW4hXCIpO1xuICAgIGNvbnNvbGUubG9nKHJlY29yZGVyKTtcblxuICAgIHJlY29yZGVyICYmIHJlY29yZGVyLmV4cG9ydFdBVihmdW5jdGlvbihibG9iKSB7XG4gICAgICBjdXJyQXVkaW9CbG9iID0gYmxvYjtcbiAgICAgIGNvbnNvbGUubG9nKFwiYXVkaW8gYmxvYiFcIik7XG5cbiAgICAgIHZhciB0aGlzUXVlc3Rpb24gPSAkKFwiLnJlY29yZC5kZWNrLWN1cnJlbnRcIikuYXR0cignZGF0YS1xdWVzdGlvbicpO1xuXG4gICAgICB2YXIgc291bmRfdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChjdXJyQXVkaW9CbG9iKTtcbiAgICAgIHZhciBhdWRpb19lbHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhdWRpbycpO1xuICAgICAgYXVkaW9fZWx0LmNvbnRyb2xzID0gdHJ1ZTtcbiAgICAgIGF1ZGlvX2VsdC5zcmMgPSBzb3VuZF91cmw7XG4gICAgICBhdWRpb19lbHQuc2V0QXR0cmlidXRlKCdkYXRhLXF1ZXN0aW9uJywgJChcIi5yZWNvcmRcIikuYXR0cignZGF0YS1xdWVzdGlvbicpKTtcblxuICAgICAgY29uc29sZS5sb2codGhpc1F1ZXN0aW9uKTtcbiAgICAgIHZhciBjdXJyUXVlc3Rpb25zUGxheWVyID0gJChcIi5yZWNvcmRbZGF0YS1xdWVzdGlvbj0nXCIrdGhpc1F1ZXN0aW9uK1wiJ10gLnBsYXlNb3N0UmVjZW50XCIpO1xuICAgICAgY3VyclF1ZXN0aW9uc1BsYXllci5odG1sKFwiXCIpO1xuICAgICAgY3VyclF1ZXN0aW9uc1BsYXllci5hcHBlbmQoICQoYXVkaW9fZWx0KSApO1xuICAgICAvLyBjdXJyUXVlc3Rpb25zUGxheWVyLmFwcGVuZCgkKGF1ZGlvX2xpbmspKTtcblxuICAgICAgY3VyclF1ZXN0aW9uc1BsYXllci5maW5kKFwiYXVkaW9cIikuYXR0cihcImRhdGEtcXVlc3Rpb25cIiwgdGhpc1F1ZXN0aW9uKTtcblxuXG4gICAgICAkKFwiLmRlY2stY3VycmVudC5yZWNvcmQgYnV0dG9uLm5leHRcIikucmVtb3ZlQ2xhc3MoXCJoaWRkZW5cIik7XG5cbiAgICAgICAgcmVjb3JkZXIuY2xlYXIoKTtcblxuICAgIH0pO1xuICB9XG5cblxuXG5cbn0pOyovXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvYXBwLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OyIsInNvdXJjZVJvb3QiOiIifQ==");

/***/ }
/******/ ]);